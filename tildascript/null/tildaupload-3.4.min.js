if(!window.reqAnimationFrame){window.reqAnimationFrame=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback,element){window.setTimeout(callback,1000/60)}})()}
function humanDigits(num,ar){var mod,res;if(ar.length==2){return num==1?ar[0]:ar[1]}
if(num==0||num==100){mod=10}else{mod=num%100}
res='';if(mod>20){mod=mod%10;mod=(mod==0)?mod=10:mod}
res=(mod<=1?ar[0]:(mod<5?ar[1]:(mod<21?ar[2]:'???')));return res}
if(typeof Tildaupload_UPLOADKEY=='undefined'){Tildaupload_UPLOADKEY=''}(function(){var Tildaupload,Emitter,camelize,contentLoaded,detectVerticalSquash,drawImageIOSFix,noop,without,__slice=[].slice,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child};noop=function(){};Emitter=(function(){function Emitter(){}
Emitter.prototype.addEventListener=Emitter.prototype.on;Emitter.prototype.on=function(event,fn){this._callbacks=this._callbacks||{};if(!this._callbacks[event]){this._callbacks[event]=[]}
this._callbacks[event].push(fn);return this};Emitter.prototype.emit=function(){var args,callback,callbacks,event,_i,_len;event=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[];this._callbacks=this._callbacks||{};callbacks=this._callbacks[event];if(callbacks){for(_i=0,_len=callbacks.length;_i<_len;_i++){callback=callbacks[_i];callback.apply(this,args)}}
return this};Emitter.prototype.removeListener=Emitter.prototype.off;Emitter.prototype.removeAllListeners=Emitter.prototype.off;Emitter.prototype.removeEventListener=Emitter.prototype.off;Emitter.prototype.off=function(event,fn){var callback,callbacks,i,_i,_len;if(!this._callbacks||arguments.length===0){this._callbacks={};return this}
callbacks=this._callbacks[event];if(!callbacks){return this}
if(arguments.length===1){delete this._callbacks[event];return this}
for(i=_i=0,_len=callbacks.length;_i<_len;i=++_i){callback=callbacks[i];if(callback===fn){callbacks.splice(i,1);break}}
return this};return Emitter})();Tildaupload=(function(_super){var extend,resolveOption;__extends(Tildaupload,_super);Tildaupload.prototype.Emitter=Emitter;Tildaupload.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","addedfile","addedfiles","removedfile","thumbnail","error","errormultiple","processing","processingmultiple","uploadprogress","totaluploadprogress","sending","sendingmultiple","success","successmultiple","canceled","canceledmultiple","complete","completemultiple","reset","maxfilesexceeded","maxfilesreached","queuecomplete"];Tildaupload.prototype.defaultOptions={url:null,method:"post",withCredentials:!1,parallelUploads:2,uploadMultiple:!1,maxFilesize:10,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:120,thumbnailHeight:120,filesizeBase:1000,maxFiles:null,params:{},clickable:!0,ignoreHiddenFiles:!0,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:!0,autoQueue:!0,addRemoveLinks:!1,previewsContainer:null,hiddenInputContainer:"body",capture:null,renameFilename:null,locale:'EN',dicts:{'EN':{defaultMessage:"Drop file here to upload",fallbackMessage:"Your browser does not support drag'n'drop file uploads.",fallbackText:"Please use the fallback form below to upload your files like in the olden days.",fileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",invalidFileType:"You can't upload files of this type.",responseError:"Server responded with {{statusCode}} code.",bigFileError:"File is too big. Max filesize: 10Mb",cancelUpload:"Cancel upload",cancelUploadConfirmation:"Are you sure you want to cancel this upload?",removeFile:"Remove file",removeFileConfirmation:null,maxFilesExceeded:"You can not upload any more files.",buttonUpload:"Upload file",buttonUploads:"Upload files",buttonUploadImage:"Upload image",buttonUploadImages:"Upload images",},'RU':{defaultMessage:"Ð‘Ñ€Ð¾ÑÑŒÑ‚Ðµ Ñ„Ð°Ð¹Ð» ÑÑŽÐ´Ð° Ð´Ð»Ñ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸",fallbackMessage:"Ð’Ð°Ñˆ Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€ Ð½Ðµ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑ‚ Ð´Ñ€Ð°Ð³ Ð°Ð½Ð´ Ð´Ñ€Ð¾Ð¿",fallbackText:"Please use the fallback form below to upload your files like in the olden days.",fileTooBig:"Ð¤Ð°Ð¹Ð» ÑÐ»Ð¸ÑˆÐºÐ¾Ð¼ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ð¹ ({{filesize}}MiB). ÐœÐ°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ€Ð°Ð·Ð¼ÐµÑ€: {{maxFilesize}}MiB.",invalidFileType:"Ð’Ñ‹ Ð½Ðµ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ð·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ñ„Ð°Ð¹Ð» ÑÑ‚Ð¾Ð³Ð¾ Ñ‚Ð¸Ð¿Ð°",responseError:"Ð¡ÐµÑ€Ð²ÐµÑ€ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ð» Ð¾Ñ‚Ð²ÐµÑ‚ {{statusCode}} ÐºÐ¾Ð´.",bigFileError:"Ð¤Ð°Ð¹Ð» Ð¾Ñ‡ÐµÐ½ÑŒ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ð¹. ÐœÐ°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ€Ð°Ð·Ð¼ÐµÑ€: 10Mb",cancelUpload:"ÐžÑ‚Ð¼ÐµÐ½Ð° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸",cancelUploadConfirmation:"Ð’Ñ‹ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ñ…Ð¾Ñ‚Ð¸Ñ‚Ðµ Ð¾Ñ‚Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÑƒ?",removeFile:"Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ñ„Ð°Ð¹Ð»",removeFileConfirmation:null,maxFilesExceeded:"Ð’Ñ‹ Ð½Ðµ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ð±Ð¾Ð»ÑŒÑˆÐµ Ð·Ð°Ð³Ñ€ÑƒÐ¶Ð°Ñ‚ÑŒ Ñ„Ð°Ð¹Ð»Ñ‹",buttonUpload:"Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ñ„Ð°Ð¹Ð»",buttonUploads:"Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ñ„Ð°Ð¹Ð»Ñ‹",buttonUploadImage:"Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ",buttonUploadImages:"Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ",}},accept:function(file,done){return done()},init:function(){return noop},forceFallback:!1,fallback:function(){var child,messageElement,span,_i,_len,_ref;this.element.className=""+this.element.className+" tu-browser-not-supported";_ref=this.element.getElementsByTagName("div");for(_i=0,_len=_ref.length;_i<_len;_i++){child=_ref[_i];if(/(^| )tu-message($| )/.test(child.className)){messageElement=child;child.className="tu-message";continue}}
if(!messageElement){messageElement=Tildaupload.createElement("<div class=\"tu-message\"><span></span></div>");this.element.appendChild(messageElement)}
span=messageElement.getElementsByTagName("span")[0];if(span){if(span.textContent!=null){span.textContent=this.options.dicts[this.options.locale].fallbackMessage}else{if(span.innerText!=null){span.innerText=this.options.dicts[this.options.locale].fallbackMessage}}}
return this.element.appendChild(this.getFallbackForm())},resize:function(file){var info,srcRatio,trgRatio;info={srcX:0,srcY:0,srcWidth:file.width,srcHeight:file.height};srcRatio=file.width/file.height;if(!this.options.thumbnailWidth&&!this.options.thumbnailHeight){var elementid=this.elementid;var $elem=$('#'+elementid);if($elem){this.options.thumbnailWidth=$elem.width()}}
info.optWidth=this.options.thumbnailWidth;info.optHeight=this.options.thumbnailHeight;if((info.optWidth==null)&&(info.optHeight==null)){info.optWidth=info.srcWidth;info.optHeight=info.srcHeight}else{if(info.optWidth==null){info.optWidth=srcRatio*info.optHeight}else{if(info.optHeight==null){info.optHeight=(1.0/srcRatio)*info.optWidth}}}
trgRatio=info.optWidth/info.optHeight;if(file.height<info.optHeight||file.width<info.optWidth){info.trgHeight=info.srcHeight;info.trgWidth=info.srcWidth}else{if(srcRatio>trgRatio){info.srcHeight=file.height;info.srcWidth=info.srcHeight*trgRatio}else{info.srcWidth=file.width;info.srcHeight=info.srcWidth/trgRatio}}
info.srcX=(file.width-info.srcWidth)/2;info.srcY=(file.height-info.srcHeight)/2;return info},drop:function(e){return this.element.classList.remove("tu-drag-hover")},dragstart:noop,dragend:function(e){return this.element.classList.remove("tu-drag-hover")},dragenter:function(e){return this.element.classList.add("tu-drag-hover")},dragover:function(e){return this.element.classList.add("tu-drag-hover")},dragleave:function(e){return this.element.classList.remove("tu-drag-hover")},paste:noop,reset:function(){return this.element.classList.remove("tu-started")},addedfile:function(file){var node,removeFileEvent,removeLink,_i,_j,_k,_len,_len1,_len2,_ref,_ref1,_ref2,_results,samePreview=!1;var elem=this.originalelement;if(!elem){elem=this.element}
var elementid=elem.getAttribute('id');this.element.classList.add("tu-started");var domPopup=document.getElementById('tu-popup');if(this.options.uploadMultiple){if(domPopup){var domPopupContent=domPopup.querySelector('.tu-popup-content');if(domPopupContent){Tildaupload.addClass(domPopupContent,'tu-uploader-multiple-screen');Tildaupload.addClass(domPopupContent,'tu-uploader-has-miltiple-img')}
this.previewsContainer=domPopup.querySelector('.tu-uploader-multiple-images');if(!file.previewElement){file.previewElement=Tildaupload.createElement(this.options.previewTemplate.trim());var lastElem=this.previewsContainer.firstChild;var len=this.previewsContainer.childNodes.length;if(len>0){if(this.previewsContainer.childNodes[len-1].nodeType==1){lastElem=this.previewsContainer.childNodes[len-1]}else{if(len>1&&this.previewsContainer.childNodes[len-2].nodeType==1){lastElem=this.previewsContainer.childNodes[len-2]}}}
this.previewsContainer.insertBefore(file.previewElement,lastElem)}
file.previewElement.querySelector('[data-tu-uploadprogress]').style.width="0%";var cnt=domPopup.querySelectorAll('.tu-js-preview-item').length;var cntText=''
if(this.options.locale=='RU'){cntText='Ð’Ñ‹ Ð²Ñ‹Ð±Ñ€Ð°Ð»Ð¸ '+cnt+' '+humanDigits(cnt,['Ñ„Ð°Ð¹Ð»','Ñ„Ð°Ð¹Ð»Ð°','Ñ„Ð°Ð¹Ð»Ð¾Ð²'])}else{if(cnt==1){cntText="You've selected "+cnt+' file'}else{cntText="You've selected "+cnt+' files'}}
domPopup.querySelector('.tu-uploader-multiple-title').innerHTML=cntText;domPopup.querySelector('.tu-uploader-multiple-nav-title').innerHTML=cntText}else{var previews=document.getElementById(elementid+'-previews');if(previews&&previews.querySelector('.tu-popup-progressbar-steps')){var elProgress=previews.querySelector('[data-tu-uploadprogress]');if(elProgress){elProgress.style.width='0%'}
Tildaupload.removeClass(previews,'tu-popup-progressbar-completed');Tildaupload.removeClass(previews,'tu-popup-progressbar-uploaded');Tildaupload.removeClass(previews,'tu-popup-progressbar-error');Tildaupload.removeClass(previews,'tu-popup-progressbar-start')}}}else{if(this.originalelement.nodeName=="IMG"){this.previewsContainer=this.originalelement;this.originalelement.setAttribute('data-tu-thumbnail','');Tildaupload.setPositionForProgressLine($('#'+elementid))}else{if(this.originalelement.nodeName=="INPUT"){var previews=document.getElementById(elementid+'-previews');if(previews&&previews.querySelector('.tu-popup-progressbar-steps')){this.previewsContainer=previews;var elProgress=previews.querySelector('[data-tu-uploadprogress]');if(elProgress){elProgress.style.width='0%'}
Tildaupload.removeClass(previews,'tu-popup-progressbar-uploaded');Tildaupload.removeClass(previews,'tu-popup-progressbar-completed');Tildaupload.removeClass(previews,'tu-popup-progressbar-error');Tildaupload.removeClass(previews,'tu-popup-progressbar-start');file.previewElement=this.previewsContainer}}else{if(this.originalelement.getAttribute('bgimgfield')){this.previewsContainer=this.originalelement.querySelector('.t-cover__carrier');if(!this.previewsContainer){this.previewsContainer=this.originalelement}
this.previewsContainer.setAttribute('data-tu-thumbnail','');file.previewElement=this.previewsContainer}else{this.previewsContainer=null}}}}
if(this.previewsContainer){if(file.previewElement){file.previewTemplate=file.previewElement;_ref=file.previewElement.querySelectorAll("[data-tu-name]");for(_i=0,_len=_ref.length;_i<_len;_i++){node=_ref[_i];node.textContent=this._renameFilename(file.name);if(this.options.fileNameSize>0&&node.textContent.length>this.options.fileNameSize){node.textContent=node.textContent.substring(0,this.options.fileNameSize-3)+'...'}}
_ref1=file.previewElement.querySelectorAll("[data-tu-size]");for(_j=0,_len1=_ref1.length;_j<_len1;_j++){node=_ref1[_j];node.innerHTML=this.filesize(file.size)}
if(this.options.addRemoveLinks){file._removeLink=Tildaupload.createElement("<a class=\"tu-remove\" href=\"javascript:undefined;\" data-tu-remove>"+this.options.dicts[this.options.locale].removeFile+"</a>");file.previewElement.appendChild(file._removeLink)}}
removeFileEvent=(function(_this){return function(e){e.preventDefault();e.stopPropagation();if(file.status===Tildaupload.UPLOADING){return Tildaupload.confirm(_this.options.dicts[_this.options.locale].cancelUploadConfirmation,function(){return _this.removeFile(file)})}else{if(_this.options.dicts[_this.options.locale].removeFileConfirmation){return Tildaupload.confirm(_this.options.dicts[_this.options.locale].removeFileConfirmation,function(){return _this.removeFile(file)})}else{return _this.removeFile(file)}}}})(this);_results=[];if(file.previewElement){_ref2=file.previewElement.querySelectorAll("[data-tu-remove]");for(_k=0,_len2=_ref2.length;_k<_len2;_k++){removeLink=_ref2[_k];_results.push(removeLink.addEventListener("click",removeFileEvent))}}
return _results}},removedfile:function(file){var _ref;if(file.previewElement){if((_ref=file.previewElement)!=null&&_ref.parentNode){_ref.parentNode.removeChild(file.previewElement)}}
return this._updateMaxFilesReachedClass()},thumbnail:function(file,dataUrl){var thumbnailElement,_i,_len,_ref;if(file.previewElement){file.previewElement.classList.remove("tu-file-preview");if(file.previewElement===this.options.originalelemet&&this.options.originalelement.nodeName.toUpperCase()=='IMG'){_ref=[file.previewElement]}else{if(file.previewElement===this.previewsContainer&&this.options.originalelement.getAttribute('bgimgfield')){_ref=[file.previewElement]}else{_ref=file.previewElement.querySelectorAll("[data-tu-thumbnail]")}}
for(_i=0,_len=_ref.length;_i<_len;_i++){thumbnailElement=_ref[_i];if(thumbnailElement.nodeName.toUpperCase()=='IMG'){thumbnailElement.alt=file.name;thumbnailElement.src=dataUrl}else{thumbnailElement.style['background-image']='url('+dataUrl+')';thumbnailElement.setAttribute('title',file.name)}}
return setTimeout(((function(_this){return function(){return file.previewElement.classList.add("tu-image-preview")}})(this)),1)}},error:function(file,message){var node,_i,_len,_ref,_results;if(!this.options.uploadMultiple){if(this.previewsContainer){this.previewsContainer.classList.add('tu-popup-progressbar-error');var domError=this.previewsContainer.querySelector('[data-tu-errormessage]');if(domError){domError.textContent=message;var errorTitle='Upload error >',domErrorTitle=this.previewsContainer.querySelector('.tu-popup-progressbar-error-title');if(domErrorTitle){errorTitle=message;if(errorTitle.length>25){errorTitle=errorTitle.substring(0,23)+'...'}
domErrorTitle.textContent=errorTitle}}else{var domError=document.getElementById('tu-global-error-container');if(!domError){domError=Tildaupload.createElement("<div id=\"tu-global-error-container\" class=\"tu-bubble-box\"><div class=\"tu-bubble-box__text\"></div></div>");domError.style.display='none';document.body.appendChild(domError)}
domError.childNodes[domError.childNodes.length-1].innerHTML=message;domError.style.display='block';window.setTimeout(function(){var domError=document.getElementById('tu-global-error-container');if(domError){domError.style.display='none'}},5000)}
var _this=this;window.setTimeout(function(){_this.previewsContainer.classList.add('tu-popup-progressbar-start');_this.previewsContainer.classList.remove('tu-popup-progressbar-error')},5000)}else{if(file.previewElement){file.previewElement.classList.add("tu-error");if(typeof message!=="String"&&message.error){message=message.error}
_ref=file.previewElement.querySelectorAll("[data-tu-errormessage]");_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){node=_ref[_i];_results.push(node.textContent=message)}}}}else{if(file.previewElement&&file.previewElement.className.indexOf('tu-uploader-multiple-img-item')>-1){var dom=file.previewElement.querySelector('.tu-uploader-multiple-img-item-error-text');if(!dom){dom=Tildaupload.createElement('<div class="tu-uploader-multiple-img-item-error-wrapper"> <div class="tu-uploader-multiple-img-item-error-icon"> <svg width="34px" height="34px" viewBox="0 0 34 34"> <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"> <g transform="translate(-28.000000, 0.000000)" fill="#FF2E2E"> <g transform="translate(28.000000, 0.000000)"> <path d="M17,33.6458333 C7.79166667,33.6458333 0.354166667,26.2083333 0.354166667,17 C0.354166667,7.79166667 7.79166667,0.354166667 17,0.354166667 C26.2083333,0.354166667 33.6458333,7.79166667 33.6458333,17 C33.6458333,26.2083333 26.2083333,33.6458333 17,33.6458333 L17,33.6458333 Z M17,1.77083333 C8.57083333,1.77083333 1.77083333,8.57083333 1.77083333,17 C1.77083333,25.4291667 8.57083333,32.2291667 17,32.2291667 C25.4291667,32.2291667 32.2291667,25.4291667 32.2291667,17 C32.2291667,8.57083333 25.4291667,1.77083333 17,1.77083333 L17,1.77083333 Z"></path> <path d="M16.3625,21.1791667 L15.725,12.325 L15.725,8.64166667 L18.275,8.64166667 L18.275,12.325 L17.7083333,21.1791667 L16.3625,21.1791667 L16.3625,21.1791667 Z M15.7958333,25.3583333 L15.7958333,23.0208333 L18.1333333,23.0208333 L18.1333333,25.3583333 L15.7958333,25.3583333 L15.7958333,25.3583333 Z"></path> </g> </g> </g> </svg> </div> <div class="tu-uploader-multiple-img-item-error-text">Upload only images</div> </div>');file.previewElement.appendChild(dom);var dom=file.previewElement.querySelector('.tu-uploader-multiple-img-item-error-text')}
dom.innerHTML=message;Tildaupload.addClass(file.previewElement,'tu-uploader-multiple-img-item-error')}}
if(this.onUserFail&&!this.options.uploadMultiple){var fn=this.onUserFail;fn.call(this,file,message)}},errormultiple:function(files,messages){console.log('['+this.elementid+'] errormultiple in '+files.length+', text: '+messages);if(this.onUserFail&&this.options.uploadMultiple){var fn=this.onUserFail;fn.call(this,files,messages)}},processing:function(file){if(file.previewElement){file.previewElement.classList.add("tu-processing");if(file._removeLink){return file._removeLink.textContent=this.options.dicts[this.options.locale].cancelUpload}}},processingmultiple:noop,uploadprogress:function(file,progress,bytesSent){var node,_i,_len,_ref,_results;if(file.previewElement){_ref=file.previewElement.querySelectorAll("[data-tu-uploadprogress]");_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){node=_ref[_i];if(node.nodeName==='PROGRESS'){_results.push(node.value=progress)}else{_results.push(node.style.width=""+progress+"%")}}
return _results}},totaluploadprogress:noop,sending:noop,sendingmultiple:noop,success:function(file,response){var _this=this;if(!file.tuInfo){file.tuInfo={}}
if(file.previewElement){if(this.options.uploadMultiple&&response&&response.result){for(var i=0;i<response.result.length;i++){if(response.result[i].originalUrl==file.name){file.tuInfo=response.result[i];file.previewElement.setAttribute('data-tu-url',response.result[i].cdnUrl);var el=file.previewElement.querySelector('[data-tu-thumbnail]');if(el&&response.result[i].cdnUrl>''){if(el.nodeName.toUpperCase()=='IMG'){el.setAttribute('src',response.result[i].cdnUrl)}else{el.style['background-image']='url('+response.result[i].cdnUrl+')'}}
var __previewElement=file.previewElement;window.setTimeout(function(){var elProgress=__previewElement.querySelector('[data-tu-uploadprogress]');if(elProgress){elProgress.style.width='0%'}},500)}}}else{if(this.element.tagName=="IMG"&&response&&response.result.length==1){file.tuInfo=response.result[0];this.element.setAttribute('src',response.result[0].cdnUrl);if(file.previewElement!=this.element.parentNode){file.previewElement.style.width='100%';file.previewElement.style.display='none';this.element.style.display=''}}else{if(this.previewsContainer.className.indexOf('tu-popup-progressbar-container')>-1){var elProgress=Tildaupload.getElement("[data-tu-uploadprogress]",'progressbar');elProgress.style.width='100%';Tildaupload.addClass(_this.previewsContainer,'tu-popup-progressbar-uploaded');window.setTimeout(function(){Tildaupload.removeClass(_this.previewsContainer,'tu-popup-progressbar-uploaded');Tildaupload.addClass(_this.previewsContainer,'tu-popup-progressbar-completed');elProgress.style.width='0%'},500)}else{if(this.element.getAttribute('bgimgfield')){var carier=this.element.querySelector('.t-cover__carrier');if(carier){carier.style['background-image']='url('+response.result[0].cdnUrl+')'}else{this.element.style['background-image']='url('+response.result[0].cdnUrl+')'}
this.element.setAttribute('data-tu-value',response.result[0].cdnUrl)}}}}
return file.previewElement.classList.add("tu-success")}else{}},successmultiple:noop,canceled:function(file){return this.emit("error",file,"Upload canceled.")},canceledmultiple:noop,complete:function(file){if(file._removeLink){file._removeLink.textContent=this.options.dicts[this.options.locale].removeFile}
if(file.previewElement){return file.previewElement.classList.add("tu-complete")}},completemultiple:noop,maxfilesexceeded:noop,maxfilesreached:noop,queuecomplete:noop,addedfiles:noop,previewTemplate:'<div class="tu-preview tu-file-preview" style="width: 180px; float: left; overflow:hidden;"><div class="tu-details dztemplate" style="display:block;position: relative; width: 180px; padding: 5px; overflow: hidden;"> <img data-tu-thumbnail /> <div class="tu-filename"><span data-tu-name id="filenamer"></span></div> <div class="tu-size" data-tu-size></div> <div class="tu-remove-file" data-tu-remove><div class="tu-close"></div></div> </div> <div class="tu-progress" style=""><span class="tu-upload" data-tu-uploadprogress></span></div> <div class="tu-success-mark" style="display:none;"><span>âœ”</span></div> <div class="tu-error-mark" style="display:none;"><span>âœ˜</span></div><div class="tu-error-message" style="display:none;"><span data-tu-errormessage></span></div></div>'};extend=function(){var key,object,objects,target,val,_i,_len;target=arguments[0],objects=2<=arguments.length?__slice.call(arguments,1):[];for(_i=0,_len=objects.length;_i<_len;_i++){object=objects[_i];for(key in object){val=object[key];target[key]=val}}
return target};function Tildaupload(element,options){var elementOptions,fallback,_ref;this.element=element;this.version=Tildaupload.version;this.defaultOptions.previewTemplate=this.defaultOptions.previewTemplate.replace(/\n*/g,"");this.clickableElements=[];this.listeners=[];this.files=[];if(typeof this.element==="string"){this.element=document.querySelector(this.element)}
if(!(this.element&&(this.element.nodeType!=null))){throw new Error("Invalid tildaupload element.")}
this.elementid=this.element.getAttribute('id');if(!this.elementid){this.elementid='tildaupload'+parseInt(Math.floor(Math.random()*(999999-99999+1))+99999);this.element.setAttribute('id',this.elementid)}
if(this.element.tildaupload){console.log("Error: Tildaupload already attached to "+this.elementid)}
this.options=extend({},this.defaultOptions,elementOptions,options!=null?options:{});if(!this.originalelement){this.originalelement=this.element}
if(this.element.nodeName=="INPUT"){var textLabel=this.options.dicts[this.options.locale].buttonUpload;if(this.options.uploadMultiple){textLabel=this.options.dicts[this.options.locale].buttonUploads}
this.element=Tildaupload.createElement('<div id="'+this.elementid+'-previews"  class="tu-popup-progressbar-container tu-popup-progressbar-start"> <div class="tu-popup-progressbar-error-container"> <div class="tu-popup-progressbar-error-wrapper"> <div class="tu-popup-progressbar-error-title">Upload error &gt; </div><div class="tu-popup-progressbar-error-text" data-tu-errormessage>Image files allowed only</div> </div> </div> <div class="tu-popup-progressbar-steps"> <div class="tu-popup-progressbar-step3"> <div class="tu-popup-toggler '+this.elementid+'-button" id="'+this.elementid+'-button">'+textLabel+'</div> <div class="tu-popup-progressbar-final '+this.elementid+'-button"> <div class="tu-popup-progressbar-final-text"> <span data-tu-name></span> <span data-tu-size>0KB</span> </div> </div> </div> <div class="tu-popup-progressbar-step2"> <div class="tu-popup-progressbar-checkmark-wrapper"> <div class="tu-popup-progressbar-checkmark"> <div class="tu-popup-progressbar-checkmark_stem"></div> <div class="tu-popup-progressbar-checkmark_kick"></div> </div> </div> </div> <div class="tu-popup-progressbar-step1"> <div class="tu-popup-progressbar-bg" data-tu-uploadprogress></div> <div class="tu-popup-progressbar-text">'+this.options.dicts[this.options.locale].uploading+'</div> <div class="tu-popup-progressbar-close-wrapper" data-tu-remove> <div class="tu-popup-progressbar-close"></div> <div class="tu-popup-progressbar-close-line tu-popup-progressbar-close-line-first"></div> <div class="tu-popup-progressbar-close-line tu-popup-progressbar-close-line-second"></div> </div> </div> </div> </div>');this.originalelement.parentNode.insertBefore(this.element,this.originalelement);this.originalelement.style.display='none';this.element.style.display=''}
Tildaupload.instances.push(this);this.element.tildaupload=this;elementOptions=(_ref=Tildaupload.optionsForElement(this.element))!=null?_ref:{};this.options=extend({},this.defaultOptions,elementOptions,options!=null?options:{});if(this.options.forceFallback||!Tildaupload.isBrowserSupported()){return this.options.fallback.call(this)}
if(this.options.url==null){this.options.url=this.element.getAttribute("action")}
if(!this.options.url){throw new Error("No URL provided.")}
if(this.options.acceptedFiles&&this.options.acceptedMimeTypes){throw new Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.")}
if(this.options.acceptedMimeTypes){this.options.acceptedFiles=this.options.acceptedMimeTypes;delete this.options.acceptedMimeTypes}
this.options.method=this.options.method.toUpperCase();if((fallback=this.getExistingFallback())&&fallback.parentNode){fallback.parentNode.removeChild(fallback)}
if(this.options.previewsContainer!==!1){if(this.options.previewsContainer){this.previewsContainer=Tildaupload.getElement(this.options.previewsContainer,"previewsContainer")}else{this.previewsContainer=this.element}}
if(this.options.uploadMultiple){this.options.previewTemplate='<div class="tu-uploader-multiple-img-item tu-js-preview-item"> <div class="tu-uploader-multiple-img-wrapper"> <div class="tu-uploader-multiple-img-separator"></div> <div class="tu-uploader-multiple-img-progressbar" data-tu-uploadprogress="" style="width:0%;"></div> <div class="tu-uploader-multiple-img" data-tu-thumbnail></div> <div class="tu-uploader-multiple-remover" data-tu-remove=""> <div class="tu-uploader-multiple-remover-line tu-uploader-multiple-remover-line-first"></div> <div class="tu-uploader-multiple-remover-line tu-uploader-multiple-remover-line-second"></div> </div> </div> </div>'}
if(this.options.clickable){if(this.options.clickable===!0){if(this.element==this.emptydropzone){var _i,_clickElements=Tildaupload.getElements('#'+this.emptydropzone.getAttribute('id')+' .tu-clickable',"clickable");this.clickableElements=[this.originalelement];for(_i=0;_i<_clickElements.length;_i++){this.clickableElements.push(_clickElements[_i])}}else{this.clickableElements=[this.element]}}else{this.clickableElements=Tildaupload.getElements(this.options.clickable,"clickable")}}
this.init()}
Tildaupload.prototype.getAcceptedFiles=function(){var file,_i,_len,_ref,_results;_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];if(file.accepted){_results.push(file)}}
return _results};Tildaupload.prototype.getRejectedFiles=function(){var file,_i,_len,_ref,_results;_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];if(!file.accepted){_results.push(file)}}
return _results};Tildaupload.prototype.getFilesWithStatus=function(status){var file,_i,_len,_ref,_results;_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];if(file.status===status){_results.push(file)}}
return _results};Tildaupload.prototype.getQueuedFiles=function(){return this.getFilesWithStatus(Tildaupload.QUEUED)};Tildaupload.prototype.getUploadingFiles=function(){return this.getFilesWithStatus(Tildaupload.UPLOADING)};Tildaupload.prototype.getAddedFiles=function(){return this.getFilesWithStatus(Tildaupload.ADDED)};Tildaupload.prototype.getActiveFiles=function(){var file,_i,_len,_ref,_results;_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];if(file.status===Tildaupload.UPLOADING||file.status===Tildaupload.QUEUED){_results.push(file)}}
return _results};Tildaupload.prototype.init=function(){var eventName,noPropagation,setupHiddenFileInput,_i,_len,_ref,_ref1;if(this.element.tagName==="form"){this.element.setAttribute("enctype","multipart/form-data")}
if(this.element.classList.contains("tildaupload")&&!this.element.querySelector(".tu-message")){this.element.appendChild(Tildaupload.createElement("<div class=\"tu-default tu-message\"><span>"+this.options.dicts[this.options.locale].defaultMessage+"</span></div>"))}
setupHiddenFileInput=(function(_this){return function(){if(_this.hiddenFileInput){_this.hiddenFileInput.parentNode.removeChild(_this.hiddenFileInput)}
_this.hiddenFileInput=document.createElement("input");_this.hiddenFileInput.setAttribute("type","file");if((_this.options.maxFiles==null)||_this.options.maxFiles>1){_this.hiddenFileInput.setAttribute("multiple","multiple")}
_this.hiddenFileInput.className="tu-hidden-input";if(_this.options.acceptedFiles!=null){_this.hiddenFileInput.setAttribute("accept",_this.options.acceptedFiles)}
if(_this.options.capture!=null){_this.hiddenFileInput.setAttribute("capture",_this.options.capture)}
_this.hiddenFileInput.style.visibility="hidden";_this.hiddenFileInput.style.position="absolute";_this.hiddenFileInput.style.top="0";_this.hiddenFileInput.style.left="0";_this.hiddenFileInput.style.height="0";_this.hiddenFileInput.style.width="0";var hidecontainer=null;if(typeof _this.options.hiddenInputContainer==="string"){hidecontainer=document.querySelector(_this.options.hiddenInputContainer)}else{if(_this.options.hiddenInputContainer&&_this.options.hiddenInputContainer.nodeType!=null){hidecontainer=_this.options.hiddenInputContainer}}
if(!hidecontainer){hidecontainer=document.querySelector('body')}
hidecontainer.appendChild(_this.hiddenFileInput);return _this.hiddenFileInput.addEventListener("change",function(){var file,files,_i,_len;files=_this.hiddenFileInput.files;if(files.length){for(_i=0,_len=files.length;_i<_len;_i++){file=files[_i];_this.addFile(file)}}
_this.emit("addedfiles",files);return setupHiddenFileInput()})}})(this);setupHiddenFileInput();this.URL=(_ref=window.URL)!=null?_ref:window.webkitURL;_ref1=this.events;for(_i=0,_len=_ref1.length;_i<_len;_i++){eventName=_ref1[_i];this.on(eventName,this.options[eventName])}
this.on("uploadprogress",(function(_this){return function(){return _this.updateTotalUploadProgress()}})(this));this.on("removedfile",(function(_this){return function(){return _this.updateTotalUploadProgress()}})(this));this.on("canceled",(function(_this){return function(file){return _this.emit("complete",file)}})(this));this.on("complete",(function(_this){return function(file){if(_this.getAddedFiles().length===0&&_this.getUploadingFiles().length===0&&_this.getQueuedFiles().length===0){return setTimeout((function(){return _this.emit("queuecomplete")}),0)}}})(this));noPropagation=function(e){e.stopPropagation();if(e.preventDefault){return e.preventDefault()}else{return e.returnValue=!1}};this.listeners=[{element:this.element,events:{"dragstart":(function(_this){return function(e){return _this.emit("dragstart",e)}})(this),"dragenter":(function(_this){return function(e){noPropagation(e);return _this.emit("dragenter",e)}})(this),"dragover":(function(_this){return function(e){var efct;try{efct=e.dataTransfer.effectAllowed}catch(_error){}
e.dataTransfer.dropEffect='move'===efct||'linkMove'===efct?'move':'copy';noPropagation(e);return _this.emit("dragover",e)}})(this),"dragleave":(function(_this){return function(e){return _this.emit("dragleave",e)}})(this),"drop":(function(_this){return function(e){noPropagation(e);return _this.drop(e)}})(this),"dragend":(function(_this){return function(e){return _this.emit("dragend",e)}})(this)}}];if(this.clickableElements.length>0){this.clickableElements.forEach((function(_this){return function(clickableElement){return _this.listeners.push({element:clickableElement,events:{"click":function(evt){if((clickableElement!==_this.element)||(evt.target===_this.element||Tildaupload.elementInside(evt.target,_this.element.querySelector(".tu-message")))){_this.hiddenFileInput.click()}
return!0}}})}})(this))}
this.enable();return this.options.init.call(this)};Tildaupload.prototype.enableAddDropZone=function(){var _this=this,addZoneElem,aa,addCssSelector,addZoneClickElem;if(this.options.additionalDropzone){if(typeof this.options.additionalDropzone=='string'){this.options.additionalDropzone=[this.options.additionalDropzone]}
for(aa=0;aa<this.options.additionalDropzone.length;aa++){addCssSelector=this.options.additionalDropzone[aa];addDropZone=Tildaupload.getElement(addCssSelector,'addDropZone');if(!addDropZone){continue}
this.clickableElements=[addDropZone.querySelector('.tu-clickable')];noPropagation=function(e){e.stopPropagation();if(e.preventDefault){return e.preventDefault()}else{return e.returnValue=!1}};addZoneElem={element:addDropZone,events:{"dragstart":(function(_this){return function(e){return _this.emit("dragstart",e)}})(this),"dragenter":(function(_this){return function(e){noPropagation(e);return _this.emit("dragenter",e)}})(this),"dragover":(function(_this){return function(e){var efct;try{efct=e.dataTransfer.effectAllowed}catch(_error){}
e.dataTransfer.dropEffect='move'===efct||'linkMove'===efct?'move':'copy';noPropagation(e);return _this.emit("dragover",e)}})(this),"dragleave":(function(_this){return function(e){return _this.emit("dragleave",e)}})(this),"drop":(function(_this){return function(e){noPropagation(e);return _this.drop(e)}})(this),"dragend":(function(_this){return function(e){return _this.emit("dragend",e)}})(this)}};this.listeners.push(addZoneElem);addZoneClickElem=addDropZone.querySelector('.tu-clickable');if(addZoneClickElem){_this.addClickableElements=[addDropZone.querySelector('.tu-clickable')];addClickElem={element:_this.addClickableElements[0],events:{"click":(function(_this){var clickableElement=_this.addClickableElements[0];return function(evt){if((clickableElement!==_this.element)||(evt.target===_this.element||Tildaupload.elementInside(evt.target,_this.element.querySelector(".tu-message")))){_this.hiddenFileInput.click()}
return!0}})(this),}};this.listeners.push(addClickElem)}else{addClickElem=null}
var elementListeners,event,listener,_i,_len,_ref,_results;if(addClickElem){_ref=[addZoneElem,addClickElem]}else{_ref=[addZoneElem]}
_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){elementListeners=_ref[_i];_results.push((function(){var _ref1,_results1;_ref1=elementListeners.events;_results1=[];for(event in _ref1){listener=_ref1[event];_results1.push(elementListeners.element.addEventListener(event,listener,!1))}
return _results1})())}}}};Tildaupload.prototype.destroy=function(){var _ref;this.disable();this.removeAllFiles(!0);if((_ref=this.hiddenFileInput)!=null?_ref.parentNode:void 0){this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput);this.hiddenFileInput=null}
delete this.element.tildaupload;return Tildaupload.instances.splice(Tildaupload.instances.indexOf(this),1)};Tildaupload.prototype.updateTotalUploadProgress=function(){var activeFiles,file,totalBytes,totalBytesSent,totalUploadProgress,_i,_len,_ref;totalBytesSent=0;totalBytes=0;activeFiles=this.getActiveFiles();if(activeFiles.length){_ref=this.getActiveFiles();for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];totalBytesSent+=file.upload.bytesSent;totalBytes+=file.upload.total}
totalUploadProgress=100*totalBytesSent/totalBytes}else{totalUploadProgress=100}
return this.emit("totaluploadprogress",totalUploadProgress,totalBytes,totalBytesSent)};Tildaupload.prototype._getParamName=function(n){if(typeof this.options.paramName==="function"){return this.options.paramName(n)}else{return ""+this.options.paramName+(this.options.uploadMultiple?"["+n+"]":"")}};Tildaupload.prototype._renameFilename=function(name){if(typeof this.options.renameFilename!=="function"){return name}
return this.options.renameFilename(name)};Tildaupload.prototype.getFallbackForm=function(){var existingFallback,fields,fieldsString,form;if(existingFallback=this.getExistingFallback()){return existingFallback}
fieldsString="<div class=\"tu-fallback\">";if(this.options.dicts[this.options.locale].fallbackText){fieldsString+="<p>"+this.options.dicts[this.options.locale].fallbackText+"</p>"}
fieldsString+="<input type=\"file\" name=\""+(this._getParamName(0))+"\" "+(this.options.uploadMultiple?'multiple="multiple"':void 0)+" /><input type=\"submit\" value=\"Upload!\"></div>";fields=Tildaupload.createElement(fieldsString);if(this.element.tagName!=="FORM"){form=Tildaupload.createElement("<form action=\""+this.options.url+"\" enctype=\"multipart/form-data\" method=\""+this.options.method+"\"></form>");form.appendChild(fields)}else{this.element.setAttribute("enctype","multipart/form-data");this.element.setAttribute("method",this.options.method)}
return form!=null?form:fields};Tildaupload.prototype.getExistingFallback=function(){var fallback,getFallback,tagName,_i,_len,_ref;getFallback=function(elements){var el,_i,_len;for(_i=0,_len=elements.length;_i<_len;_i++){el=elements[_i];if(/(^| )fallback($| )/.test(el.className)){return el}}};_ref=["div","form"];for(_i=0,_len=_ref.length;_i<_len;_i++){tagName=_ref[_i];if(fallback=getFallback(this.element.getElementsByTagName(tagName))){return fallback}}};Tildaupload.prototype.setupEventListeners=function(){var elementListeners,event,listener,_i,_len,_ref,_results;_ref=this.listeners;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){elementListeners=_ref[_i];_results.push((function(){var _ref1,_results1;_ref1=elementListeners.events;_results1=[];for(event in _ref1){listener=_ref1[event];_results1.push(elementListeners.element.addEventListener(event,listener,!1))}
return _results1})())}
return _results};Tildaupload.prototype.removeEventListeners=function(){var elementListeners,event,listener,_i,_len,_ref,_results;_ref=this.listeners;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){elementListeners=_ref[_i];_results.push((function(){var _ref1,_results1;_ref1=elementListeners.events;_results1=[];for(event in _ref1){listener=_ref1[event];_results1.push(elementListeners.element.removeEventListener(event,listener,!1))}
return _results1})())}
return _results};Tildaupload.prototype.disable=function(){var file,_i,_len,_ref,_results;this.clickableElements.forEach(function(element){return element.classList.remove("tu-clickable")});this.removeEventListeners();_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];_results.push(this.cancelUpload(file))}
return _results};Tildaupload.prototype.enable=function(){this.clickableElements.forEach(function(element){return element.classList.add("tu-clickable")});return this.setupEventListeners()};Tildaupload.prototype.filesize=function(size){var cutoff,i,selectedSize,selectedUnit,unit,units,_i,_len;selectedSize=0;selectedUnit="b";if(size>0){units=['TB','GB','MB','KB','b'];for(i=_i=0,_len=units.length;_i<_len;i=++_i){unit=units[i];cutoff=Math.pow(this.options.filesizeBase,4-i)/10;if(size>=cutoff){selectedSize=size/Math.pow(this.options.filesizeBase,4-i);selectedUnit=unit;break}}
selectedSize=Math.round(10*selectedSize)/10;return "<strong>"+selectedSize+"</strong> "+selectedUnit}
return ""};Tildaupload.prototype.sizeUploadedFiles=function(){var size=0,i,file,sufix='';if(this.files&&this.files.length>0){for(i=0;i<this.files.length;i++){file=this.files[i];size+=file.size}
if(size>1024){size=parseFloat(size/1024);sufix='Kb';if(size>1024){size=parseFloat(size/1024);sufix='Mb'}}
if(size>0){size=''+size;size=size.substring(0,4);return "<strong>"+size+"</strong> "+sufix}}
return ""};Tildaupload.prototype._updateMaxFilesReachedClass=function(){if((this.options.maxFiles!=null)&&this.getAcceptedFiles().length>=this.options.maxFiles){if(this.getAcceptedFiles().length===this.options.maxFiles){this.emit('maxfilesreached',this.files)}
return this.element.classList.add("tu-max-files-reached")}else{return this.element.classList.remove("tu-max-files-reached")}};Tildaupload.prototype.drop=function(e){var files,items;if(!e.dataTransfer){return}
this.emit("drop",e);files=e.dataTransfer.files;this.emit("addedfiles",files);if(files.length){items=e.dataTransfer.items;if(items&&items.length&&(items[0].webkitGetAsEntry!=null)){this._addFilesFromItems(items)}else{this.handleFiles(files)}}else{if(e.dataTransfer.types&&e.dataTransfer.types.length>0){var _i,type,url;for(_i in e.dataTransfer.types){type=e.dataTransfer.types[_i];if(type.indexOf('url')>0||type.indexOf('uri-')>0){url=e.dataTransfer.getData(type);if(url>''){this._addFilesFromItems([{url:url}]);break}}}}}};Tildaupload.prototype.paste=function(e){var items,_ref;if((e!=null?(_ref=e.clipboardData)!=null?_ref.items:void 0:void 0)==null){return}
this.emit("paste",e);items=e.clipboardData.items;if(items.length){return this._addFilesFromItems(items)}};Tildaupload.prototype.handleFiles=function(files){var file,_i,_len,_results;_results=[];for(_i=0,_len=files.length;_i<_len;_i++){file=files[_i];_results.push(this.addFile(file))}
return _results};Tildaupload.prototype._addFilesFromItems=function(items){var entry,item,_i,_len,_results;_results=[];for(_i=0,_len=items.length;_i<_len;_i++){item=items[_i];if((item.webkitGetAsEntry!=null)&&(entry=item.webkitGetAsEntry())){if(entry.isFile){_results.push(this.addFile(item.getAsFile()))}else{if(entry.isDirectory){_results.push(this._addFilesFromDirectory(entry,entry.name))}else{_results.push(void 0)}}}else{if(item.getAsFile!=null){if((item.kind==null)||item.kind==="file"){_results.push(this.addFile(item.getAsFile()))}else{_results.push(void 0)}}else{if(item.url>''){this.uploadFileFromURL(item.url)}else{_results.push(void 0)}}}}
return _results};Tildaupload.prototype._addFilesFromDirectory=function(directory,path){var dirReader,errorHandler,readEntries;dirReader=directory.createReader();errorHandler=function(error){return typeof console!=="undefined"&&console!==null?typeof console.log==="function"?console.log(error):void 0:void 0};readEntries=(function(_this){return function(){return dirReader.readEntries(function(entries){var entry,_i,_len;if(entries.length>0){for(_i=0,_len=entries.length;_i<_len;_i++){entry=entries[_i];if(entry.isFile){entry.file(function(file){if(_this.options.ignoreHiddenFiles&&file.name.substring(0,1)==='.'){return}
file.fullPath=""+path+"/"+file.name;return _this.addFile(file)})}else{if(entry.isDirectory){_this._addFilesFromDirectory(entry,""+path+"/"+entry.name)}}}
readEntries()}
return null},errorHandler)}})(this);return readEntries()};Tildaupload.prototype.accept=function(file,done){if(file.size>this.options.maxFilesize*1024*1024){return done(this.options.dicts[this.options.locale].fileTooBig.replace("{{filesize}}",Math.round(file.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize))}else{if(!Tildaupload.isValidFile(file,this.options.acceptedFiles)){return done(this.options.dicts[this.options.locale].invalidFileType)}else{if((this.options.maxFiles!=null)&&this.getAcceptedFiles().length>=this.options.maxFiles){done(this.options.dicts[this.options.locale].maxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles));return this.emit("maxfilesexceeded",file)}else{return this.options.accept.call(this,file,done)}}}};Tildaupload.prototype.addFile=function(file){file.upload={progress:0,total:file.size,bytesSent:0};this.files.push(file);file.status=Tildaupload.ADDED;this.emit("addedfile",file);this._enqueueThumbnail(file);return this.accept(file,(function(_this){return function(error){if(error){file.accepted=!1;_this._errorProcessing([file],error)}else{file.accepted=!0;if(_this.options.autoQueue){_this.enqueueFile(file)}}
return _this._updateMaxFilesReachedClass()}})(this))};Tildaupload.prototype.enqueueFiles=function(files){var file,_i,_len;for(_i=0,_len=files.length;_i<_len;_i++){file=files[_i];this.enqueueFile(file)}
return null};Tildaupload.prototype.enqueueFile=function(file){if(file.status===Tildaupload.ADDED&&file.accepted===!0){file.status=Tildaupload.QUEUED;if(this.options.autoProcessQueue){return setTimeout(((function(_this){return function(){return _this.processQueue()}})(this)),0)}}else{throw new Error("This file can't be queued because it has already been processed or was rejected.")}};Tildaupload.prototype._thumbnailQueue=[];Tildaupload.prototype._processingThumbnail=!1;Tildaupload.prototype._enqueueThumbnail=function(file){if(this.options.createImageThumbnails&&file.type.match(/image.*/)&&file.size<=this.options.maxThumbnailFilesize*1024*1024){this._thumbnailQueue.push(file);return setTimeout(((function(_this){return function(){return _this._processThumbnailQueue()}})(this)),0)}};Tildaupload.prototype._processThumbnailQueue=function(){if(this._processingThumbnail||this._thumbnailQueue.length===0){return}
this._processingThumbnail=!0;return this.createThumbnail(this._thumbnailQueue.shift(),(function(_this){return function(){_this._processingThumbnail=!1;return _this._processThumbnailQueue()}})(this))};Tildaupload.prototype.removeFile=function(file){if(file.status===Tildaupload.UPLOADING){this.cancelUpload(file)}
this.files=without(this.files,file);this.emit("removedfile",file);if(this.files.length===0){return this.emit("reset")}};Tildaupload.prototype.removeAllFiles=function(cancelIfNecessary){var file,_i,_len,_ref;if(cancelIfNecessary==null){cancelIfNecessary=!1}
_ref=this.files.slice();for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];if(file.status!==Tildaupload.UPLOADING||cancelIfNecessary){if(file.previewElement&&file.previewElement.className.indexOf('tu-popup-progressbar-container')>-1){file.previewElement=!1}
this.removeFile(file)}}
return null};Tildaupload.prototype.createThumbnail=function(file,callback){var fileReader;fileReader=new FileReader;fileReader.onload=(function(_this){return function(){if(file.type==="image/svg+xml"){_this.emit("thumbnail",file,fileReader.result);if(callback!=null){callback()}
return}
return _this.createThumbnailFromUrl(file,fileReader.result,callback)}})(this);return fileReader.readAsDataURL(file)};Tildaupload.prototype.createThumbnailFromUrl=function(file,imageUrl,callback,crossOrigin){var img;img=document.createElement("img");if(crossOrigin){img.crossOrigin=crossOrigin}
img.onload=(function(_this){return function(){var canvas,ctx,resizeInfo,thumbnail,_ref,_ref1,_ref2,_ref3;file.width=img.width;file.height=img.height;resizeInfo=_this.options.resize.call(_this,file);if(resizeInfo.trgWidth==null){resizeInfo.trgWidth=resizeInfo.optWidth}
if(resizeInfo.trgHeight==null){resizeInfo.trgHeight=resizeInfo.optHeight}
canvas=document.createElement("canvas");ctx=canvas.getContext("2d");canvas.width=resizeInfo.trgWidth;canvas.height=resizeInfo.trgHeight;drawImageIOSFix(ctx,img,(_ref=resizeInfo.srcX)!=null?_ref:0,(_ref1=resizeInfo.srcY)!=null?_ref1:0,resizeInfo.srcWidth,resizeInfo.srcHeight,(_ref2=resizeInfo.trgX)!=null?_ref2:0,(_ref3=resizeInfo.trgY)!=null?_ref3:0,resizeInfo.trgWidth,resizeInfo.trgHeight);thumbnail=canvas.toDataURL("image/png");_this.emit("thumbnail",file,thumbnail);if(callback!=null){return callback()}}})(this);if(callback!=null){img.onerror=callback}
return img.src=imageUrl};Tildaupload.prototype.processQueue=function(){var i,parallelUploads,processingLength,queuedFiles;parallelUploads=this.options.parallelUploads;processingLength=this.getUploadingFiles().length;i=processingLength;if(processingLength>=parallelUploads){return}
queuedFiles=this.getQueuedFiles();if(!(queuedFiles.length>0)){return}
if(this.options.uploadMultiple){return this.processFiles(queuedFiles.slice(0,parallelUploads-processingLength))}else{while(i<parallelUploads){if(!queuedFiles.length){return}
this.processFile(queuedFiles.shift());i++}}};Tildaupload.prototype.processFile=function(file){return this.processFiles([file])};Tildaupload.prototype.processFiles=function(files){var file,_i,_len;for(_i=0,_len=files.length;_i<_len;_i++){file=files[_i];file.processing=!0;file.status=Tildaupload.UPLOADING;this.emit("processing",file)}
if(this.options.uploadMultiple){this.emit("processingmultiple",files)}
return this.uploadFiles(files)};Tildaupload.prototype._getFilesWithXhr=function(xhr){var file,files;return files=(function(){var _i,_len,_ref,_results;_ref=this.files;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){file=_ref[_i];if(file.xhr===xhr){_results.push(file)}}
return _results}).call(this)};Tildaupload.prototype.cancelUpload=function(file){var groupedFile,groupedFiles,_i,_j,_len,_len1,_ref;if(file.status===Tildaupload.UPLOADING){groupedFiles=this._getFilesWithXhr(file.xhr);for(_i=0,_len=groupedFiles.length;_i<_len;_i++){groupedFile=groupedFiles[_i];groupedFile.status=Tildaupload.CANCELED}
file.xhr.abort();for(_j=0,_len1=groupedFiles.length;_j<_len1;_j++){groupedFile=groupedFiles[_j];this.emit("canceled",groupedFile)}
if(this.options.uploadMultiple){this.emit("canceledmultiple",groupedFiles)}}else{if((_ref=file.status)===Tildaupload.ADDED||_ref===Tildaupload.QUEUED){file.status=Tildaupload.CANCELED;this.emit("canceled",file);if(this.options.uploadMultiple){this.emit("canceledmultiple",[file])}}}
if(this.options.autoProcessQueue){return this.processQueue()}};resolveOption=function(){var args,option;option=arguments[0],args=2<=arguments.length?__slice.call(arguments,1):[];if(typeof option==='function'){return option.apply(this,args)}
return option};Tildaupload.prototype.uploadFile=function(file){return this.uploadFiles([file])};Tildaupload.prototype.uploadFiles=function(files){var file,formData,handleError,headerName,headerValue,headers,i,input,inputName,inputType,key,method,option,progressObj,response,updateProgress,url,value,xhr,_i,_j,_k,_l,_len,_len1,_len2,_len3,_m,_ref,_ref1,_ref2,_ref3,_ref4,_ref5;xhr=new XMLHttpRequest();for(_i=0,_len=files.length;_i<_len;_i++){file=files[_i];file.xhr=xhr}
method=resolveOption(this.options.method,files);var addparamstr='';if(this.element.getAttribute('data-tu-max-width')>0){addparamstr+='&maxwidth='+parseInt(this.element.getAttribute('data-tu-max-width'))}
if(this.element.getAttribute('data-tu-max-height')>0){addparamstr+='&maxheight='+parseInt(this.element.getAttribute('data-tu-max-height'))}
if(this.element.getAttribute('data-tu-cover')&&this.element.getAttribute('data-tu-cover')!=''){addparamstr+='&crop='+this.element.getAttribute('data-tu-cover')}
url=resolveOption(this.options.url,files);xhr.open(method,url+addparamstr,!0);xhr.withCredentials=!!this.options.withCredentials;response=null;handleError=(function(_this){return function(){var _j,_len1,_results;_results=[];for(_j=0,_len1=files.length;_j<_len1;_j++){file=files[_j];if(xhr.status==0){_results.push(_this._errorProcessing(files,response||_this.options.dicts[_this.options.locale].bigFileError,xhr))}else{_results.push(_this._errorProcessing(files,response||_this.options.dicts[_this.options.locale].responseError.replace("{{statusCode}}",xhr.status),xhr))}}
return _results}})(this);updateProgress=(function(_this){return function(e){var allFilesFinished,progress,_j,_k,_l,_len1,_len2,_len3,_results;if(e!=null){progress=100*e.loaded/e.total;for(_j=0,_len1=files.length;_j<_len1;_j++){file=files[_j];file.upload={progress:progress,total:e.total,bytesSent:e.loaded}}}else{allFilesFinished=!0;progress=100;for(_k=0,_len2=files.length;_k<_len2;_k++){file=files[_k];if(!(file.upload.progress===100&&file.upload.bytesSent===file.upload.total)){allFilesFinished=!1}
file.upload.progress=progress;file.upload.bytesSent=file.upload.total}
if(allFilesFinished){return}}
_results=[];for(_l=0,_len3=files.length;_l<_len3;_l++){file=files[_l];_results.push(_this.emit("uploadprogress",file,progress,file.upload.bytesSent))}
return _results}})(this);xhr.onload=(function(_this){return function(e){var _ref;if(files[0].status===Tildaupload.CANCELED){return}
if(xhr.readyState!==4){return}
response=xhr.responseText;if(xhr.getResponseHeader("content-type")&&~xhr.getResponseHeader("content-type").indexOf("application/json")){try{response=JSON.parse(response)}catch(_error){e=_error;response="Invalid JSON response from server."}}
updateProgress();if(!((200<=(_ref=xhr.status)&&_ref<300))){return handleError()}else{return _this._finished(files,response,e)}}})(this);xhr.onerror=(function(_this){return function(){if(files[0].status===Tildaupload.CANCELED){return}
return handleError()}})(this);progressObj=(_ref=xhr.upload)!=null?_ref:xhr;progressObj.onprogress=updateProgress;headers={"Accept":"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"};if(this.options.headers){extend(headers,this.options.headers)}
for(headerName in headers){headerValue=headers[headerName];if(headerValue){xhr.setRequestHeader(headerName,headerValue)}}
formData=new FormData();if(Tildaupload_PUBLICKEY){formData.append('publickey',Tildaupload_PUBLICKEY)}
if(Tildaupload_UPLOADKEY){formData.append('uploadkey',Tildaupload_UPLOADKEY)}
if(this.options.params){_ref1=this.options.params;for(key in _ref1){value=_ref1[key];formData.append(key,value)}}
for(_j=0,_len1=files.length;_j<_len1;_j++){file=files[_j];this.emit("sending",file,xhr,formData)}
if(this.options.uploadMultiple){this.emit("sendingmultiple",files,xhr,formData)}
if(this.element.tagName==="FORM"){_ref2=this.element.querySelectorAll("input, textarea, select, button");for(_k=0,_len2=_ref2.length;_k<_len2;_k++){input=_ref2[_k];inputName=input.getAttribute("name");inputType=input.getAttribute("type");if(input.tagName==="SELECT"&&input.hasAttribute("multiple")){_ref3=input.options;for(_l=0,_len3=_ref3.length;_l<_len3;_l++){option=_ref3[_l];if(option.selected){formData.append(inputName,option.value)}}}else{if(!inputType||((_ref4=inputType.toLowerCase())!=="checkbox"&&_ref4!=="radio")||input.checked){formData.append(inputName,input.value)}}}}
for(i=_m=0,_ref5=files.length-1;0<=_ref5?_m<=_ref5:_m>=_ref5;i=0<=_ref5?++_m:--_m){formData.append(this._getParamName(i),files[i],this._renameFilename(files[i].name))}
return this.submitRequest(xhr,formData,files)};Tildaupload.prototype.submitRequest=function(xhr,formData,files){return xhr.send(formData)};Tildaupload.prototype._finished=function(files,responseText,e){var file,_i,_len,k,resultInfo,errorExists=0;for(_i=0,_len=files.length;_i<_len;_i++){file=files[_i];resultInfo='';if(responseText&&responseText.errorExists&&responseText.result&&responseText.errorExists>0){for(k=0;k<responseText.result.length;k++){resultInfo=responseText.result[k];if((file.name==resultInfo.originalUrl)||(file.name==undefined&&resultInfo.originalUrl=='blob')){file.tuInfo=responseText.result[k];break}
resultInfo=''}}
if(resultInfo&&resultInfo.error){file.status=Tildaupload.ERROR;this.emit("error",file,resultInfo.error,e);errorExists=1}else{file.status=Tildaupload.SUCCESS;this.emit("success",file,responseText,e)}
this.emit("complete",file)}
if(this.options.uploadMultiple){if(errorExists){this.emit("errormultiple",files,responseText,e)}else{this.emit("successmultiple",files,responseText,e)}
this.emit("completemultiple",files)}
if(this.options.autoProcessQueue){return this.processQueue()}};Tildaupload.prototype._errorProcessing=function(files,message,xhr){var file,_i,_len;for(_i=0,_len=files.length;_i<_len;_i++){file=files[_i];file.status=Tildaupload.ERROR;this.emit("error",file,message,xhr);this.emit("complete",file)}
if(this.options.uploadMultiple){this.emit("errormultiple",files,message,xhr);this.emit("completemultiple",files)}
if(this.options.autoProcessQueue){return this.processQueue()}};Tildaupload.prototype.uploadFileFromURL=function(url){var elem=this.originalelement;if(!elem){elem=this.element}
var elementid=elem.getAttribute('id');var _this=this;var tmp=url.split("\n");var acceptedFiles='image/*';if(tmp&&tmp.length>1){url=tmp[0]}
var file={url:url,name:url,size:''};file.upload={progress:0,total:file.size,bytesSent:0};_this.files.push(file);file.status=Tildaupload.ADDED;_this.emit("addedfile",file);var addparamstr='';if(this.element.getAttribute('data-tu-max-width')>0){addparamstr+='&maxwidth='+parseInt(this.element.getAttribute('data-tu-max-width'))}
if(this.element.getAttribute('data-tu-max-height')>0){addparamstr+='&maxheight='+parseInt(this.element.getAttribute('data-tu-max-height'))}
if(this.element.getAttribute('data-tu-cover')&&this.element.getAttribute('data-tu-cover')!=''){addparamstr+='&crop='+this.element.getAttribute('data-tu-cover')}
acceptedFiles=(this.element.getAttribute('data-tu-is-image')=='no'?(this.element.getAttribute('data-tu-accepted-files')>''?this.element.getAttribute('data-tu-accepted-files'):'no'):'image/*');$.ajax({url:this.options.url+addparamstr,type:'POST',dataType:'text',timeout:10000,data:{url:url,publickey:Tildaupload_PUBLICKEY,uploadkey:Tildaupload_UPLOADKEY,acceptedFiles:acceptedFiles},beforeSend:function(){$('#'+elementid+'-previews').css({display:'inline-block'});var $prev=$('#'+elementid+'-previews');if($prev.length>0){$prev.removeClass('tu-popup-progressbar-error').removeClass('tu-popup-progressbar-completed').removeClass('tu-popup-progressbar-uploaded').removeClass('tu-popup-progressbar-start')}
TUWidget.hideUploader()},xhr:function(){var xhr=$.ajaxSettings.xhr();xhr.upload.addEventListener('progress',function(evt){if(evt.lengthComputable){var percentComplete=Math.ceil(evt.loaded/evt.total*100);_this.emit("progress",percentComplete,evt.loaded)}},!1);return xhr},success:function(response){if(response&&typeof response=='string'&&response.substring(0,1)=='{'){response=$.parseJSON(response)}else{console.log(response)}
var $popup=$('#tu-popup');var $elem=$('#'+elementid),off;var tu=_this;if(response&&response.result&&response.result[0].cdnUrl>''){_this._finished(_this.files,response);return!0}else{var tu=$elem.data('tildaupload');var $previews=$('#'+elementid+'-previews');if($previews.length>0){$previews.removeClass('tu-popup-progressbar-completed');$previews.removeClass('tu-popup-progressbar-success');$previews.removeClass('tu-popup-progressbar-start');$previews.addClass('tu-popup-progressbar-error');var errorText='',errorTitle='Upload error >',ee;if(response&&response.result&&response.result[0]){for(ee in response.result){if(response.result[ee].error&&response.result[ee].error>''){errorText+=response.result[ee].error+'<br>'}}}
if(errorText==''){errorText='Upload only image files'}
if(errorText.length>25){errorTitle=errorText.substring(0,23)+'...'}else{errorTitle=errorText}
$previews.find('.tu-popup-progressbar-error-title').html(errorTitle)
$previews.find('.tu-popup-progressbar-error-text').html(errorText);window.setTimeout(function(){$previews.removeClass('tu-popup-progressbar-error');$previews.addClass('tu-popup-progressbar-start')},5000)}else{if($('#'+elementid+'-progress').length>0){Tildaupload.setPositionForProgressLine($elem);$('#'+elementid+'-progress').css({background:'#FF2222'})}}
if(tu.onUserFail&&!tu.options.uploadMultiple){var fn=tu.onUserFail;fn.call(tu,url,response)}}},error:function(result){console.log('error');console.log(result);var tu=$elem.data('tildaupload');if(tu.onUserFail&&!tu.options.uploadMultiple){var fn=tu.onUserFail;fn.call(tu,url,result)}}})};Tildaupload.prototype.done=function(fn){this.onUserDone=fn;return this};Tildaupload.prototype.fail=function(fn){this.onUserFail=fn;return this};Tildaupload.prototype.progress=function(fn){this.onUserProgress=fn;return this};return Tildaupload})(Emitter);Tildaupload.version="4.3.0";Tildaupload.options={};Tildaupload.optionsForElement=function(element){if(element.getAttribute("id")){return Tildaupload.options[camelize(element.getAttribute("id"))]}else{return void 0}};Tildaupload.instances=[];Tildaupload.forElement=function(element){if(typeof element==="string"){element=document.querySelector(element)}
if((element!=null?element.tildaupload:void 0)==null){throw new Error("No Tildaupload found for given element. This is probably because you're trying to access it before Tildaupload had the time to initialize. Use the `init` option to setup any additional observers on your Tildaupload.")}
return element.tildaupload};Tildaupload.autoDiscover=!0;Tildaupload.discover=function(){var checkElements,tildaupload,tildauploads,_i,_len,_results;if(document.querySelectorAll){tildauploads=document.querySelectorAll(".tildaupload")}else{tildauploads=[];checkElements=function(elements){var el,_i,_len,_results;_results=[];for(_i=0,_len=elements.length;_i<_len;_i++){el=elements[_i];if(/(^| )tildaupload($| )/.test(el.className)){_results.push(tildauploads.push(el))}else{_results.push(void 0)}}
return _results};checkElements(document.getElementsByTagName("div"));checkElements(document.getElementsByTagName("form"))}
_results=[];for(_i=0,_len=tildauploads.length;_i<_len;_i++){tildaupload=tildauploads[_i];if(Tildaupload.optionsForElement(tildaupload)!==!1){_results.push(new Tildaupload(tildaupload))}else{_results.push(void 0)}}
return _results};Tildaupload.blacklistedBrowsers=[/opera.*Macintosh.*version\/12/i];Tildaupload.isBrowserSupported=function(){var capableBrowser,regex,_i,_len,_ref;capableBrowser=!0;if(window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector){if(!("classList" in document.createElement("a"))){capableBrowser=!1}else{_ref=Tildaupload.blacklistedBrowsers;for(_i=0,_len=_ref.length;_i<_len;_i++){regex=_ref[_i];if(regex.test(navigator.userAgent)){capableBrowser=!1;continue}}}}else{capableBrowser=!1}
return capableBrowser};without=function(list,rejectedItem){var item,_i,_len,_results;_results=[];for(_i=0,_len=list.length;_i<_len;_i++){item=list[_i];if(item!==rejectedItem){_results.push(item)}}
return _results};camelize=function(str){return str.replace(/[\-_](\w)/g,function(match){return match.charAt(1).toUpperCase()})};Tildaupload.createElement=function(string){var div;div=document.createElement("div");div.innerHTML=string;return div.childNodes[0]};Tildaupload.elementInside=function(element,container){if(element===container){return!0}
while(element=element.parentNode){if(element===container){return!0}}
return!1};Tildaupload.addClass=function(el,className){var element;if(typeof el==="string"){element=document.querySelector(el)}else{if(el.nodeType!=null){element=el}}
if(element){if(element.classList){element.classList.add(className)}else{if(element.className.indexOf(className)>-1){element.className+=className}}}};Tildaupload.setPositionForProgressLine=function($elem){var off=$elem.position();var off2=$elem.offset();var elementid=$elem.attr('id');if($('#'+elementid+'-progress').length>0){if($elem.attr('bgimgfield')>''||$elem.hasClass('tn-atom__img')){$('#'+elementid+'-progress').css({width:parseInt($elem.width())+'px'})}else{$('#'+elementid+'-progress').css({top:parseInt(off.top+$elem.height())+'px',left:off2.left+'px',width:parseInt($elem.width())+'px'})}}
return $elem};Tildaupload.removeClass=function(el,className){var element;if(typeof el==="string"){element=document.querySelector(el)}else{if(el.nodeType!=null){element=el}}
if(element){if(element.classList){element.classList.remove(className)}else{element.className=element.className.replace('/\b'+className+'/g',"")}}};Tildaupload.getElement=function(el,name){var element;if(typeof el==="string"){element=document.querySelector(el);if(element==null&&jQuery){element=jQuery(el);if(element.length>0){element=element.get(0)}else{element=null}}}else{if(el.nodeType!=null){element=el}}
if(element==null){throw new Error("Invalid `"+name+"` option provided. Please provide a CSS selector or a plain HTML element.")}
return element};Tildaupload.getElements=function(els,name){var e,el,elements,_i,_j,_len,_len1,_ref;if(els instanceof Array){elements=[];try{for(_i=0,_len=els.length;_i<_len;_i++){el=els[_i];elements.push(this.getElement(el,name))}}catch(_error){e=_error;elements=null}}else{if(typeof els==="string"){elements=[];_ref=document.querySelectorAll(els);for(_j=0,_len1=_ref.length;_j<_len1;_j++){el=_ref[_j];elements.push(el)}}else{if(els.nodeType!=null){elements=[els]}}}
if(!((elements!=null)&&elements.length)){throw new Error("Invalid `"+name+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.")}
return elements};Tildaupload.confirm=function(question,accepted,rejected){if(window.confirm(question)){return accepted()}else{if(rejected!=null){return rejected()}}};Tildaupload.isValidFile=function(file,acceptedFiles){var baseMimeType,mimeType,validType,_i,_len;if(!acceptedFiles){return!0}
acceptedFiles=acceptedFiles.split(",");mimeType=file.type;baseMimeType=mimeType.replace(/\/.*$/,"");for(_i=0,_len=acceptedFiles.length;_i<_len;_i++){validType=acceptedFiles[_i];validType=validType.trim();if(validType.charAt(0)==="."){if(file.name.toLowerCase().indexOf(validType.toLowerCase(),file.name.length-validType.length)!==-1){return!0}}else{if(/\/\*$/.test(validType)){if(baseMimeType===validType.replace(/\/.*$/,"")){return!0}}else{if(mimeType===validType){return!0}}}}
return!1};Tildaupload.animate=function(elem,options,userspeed,callback){var speed,len,str;var curoptions=options;var cur;if(userspeed=='slow'){speed=500}else{if(userspeed=='fast'){speed=17}else{if(userspeed>0){speed=userspeed}else{speed=100}}}
for(cssName in options){if(elem.style[cssName]!==undefined){if(!options[cssName].start){options[cssName].start=0}
if(options[cssName].start<options[cssName].end){options[cssName].step=Math.abs(options[cssName].step)}else{options[cssName].step=-Math.abs(options[cssName].step)}
elem.style[cssName]=options[cssName].start;str=(''+options[cssName].start);len=str.length;str=str.substring(len-2);if(str=='px'){options[cssName].unit='px'}else{if(str=='pt'){options[cssName].unit='pt'}else{if(str.substring(1)=='%'){options[cssName].unit='%'}else{options[cssName].unit=''}}}}}(function animate(){var isFinished=!0;for(cssName in options){if(elem.style[cssName]!==undefined){if((options[cssName].start<options[cssName].end&&elem.style[cssName]<options[cssName].end)||(options[cssName].start>options[cssName].end&&elem.style[cssName]>options[cssName].end)){if(options[cssName].step>0.0&&options[cssName].step<1){cur=parseFloat(elem.style[cssName])+parseFloat(options[cssName].step)}else{cur=parseInt(elem.style[cssName])+parseInt(options[cssName].step)}
elem.style[cssName]=(cur+options[cssName].unit);isFinished=!1}}}
if(!isFinished){setTimeout(function(){window.reqAnimationFrame(animate)},speed)}else{if(typeof callback=='function'){callback(elem)}}})()};function fadeOut(el,userstep){Tildaupload.animate(el,{'opacity':{'start':1,'end':0,'step':0.1}},userstep,function(el){el.style.display='none';el.setAttribute('data-is-hidden','1')})}
function fadeIn(el,userstep,callback){if(el.getAttribute('data-is-hidden')){el.setAttribute('data-is-hidden','0')}
el.style.opacity=0;el.style.display="block";Tildaupload.animate(el,{'opacity':{'start':0,'end':1,'step':0.1}},userstep,callback)}
if(typeof jQuery!=="undefined"&&jQuery!==null){jQuery.fn.tildaupload=function(options){return this.each(function(){return new Tildaupload(this,options)})}}
if(typeof module!=="undefined"&&module!==null){module.exports=Tildaupload}else{window.Tildaupload=Tildaupload}
Tildaupload.ADDED="added";Tildaupload.QUEUED="queued";Tildaupload.ACCEPTED=Tildaupload.QUEUED;Tildaupload.UPLOADING="uploading";Tildaupload.PROCESSING=Tildaupload.UPLOADING;Tildaupload.CANCELED="canceled";Tildaupload.ERROR="error";Tildaupload.SUCCESS="success";detectVerticalSquash=function(img){var alpha,canvas,ctx,data,ey,ih,iw,py,ratio,sy;iw=img.naturalWidth;ih=img.naturalHeight;canvas=document.createElement("canvas");canvas.width=1;canvas.height=ih;ctx=canvas.getContext("2d");ctx.drawImage(img,0,0);data=ctx.getImageData(0,0,1,ih).data;sy=0;ey=ih;py=ih;while(py>sy){alpha=data[(py-1)*4+3];if(alpha===0){ey=py}else{sy=py}
py=(ey+sy)>>1}
ratio=py/ih;if(ratio===0){return 1}else{return ratio}};drawImageIOSFix=function(ctx,img,sx,sy,sw,sh,dx,dy,dw,dh){var vertSquashRatio;vertSquashRatio=detectVerticalSquash(img);return ctx.drawImage(img,sx,sy,sw,sh,dx,dy,dw,dh/vertSquashRatio)};contentLoaded=function(win,fn){var add,doc,done,init,poll,pre,rem,root,top;done=!1;top=!0;doc=win.document;root=doc.documentElement;add=(doc.addEventListener?"addEventListener":"attachEvent");rem=(doc.addEventListener?"removeEventListener":"detachEvent");pre=(doc.addEventListener?"":"on");init=function(e){if(e.type==="readystatechange"&&doc.readyState!=="complete"){return}(e.type==="load"?win:doc)[rem](pre+e.type,init,!1);if(!done&&(done=!0)){return fn.call(win,e.type||e)}};poll=function(){var e;try{root.doScroll("left")}catch(_error){e=_error;setTimeout(poll,50);return}
return init("poll")};if(doc.readyState!=="complete"){if(doc.createEventObject&&root.doScroll){try{top=!win.frameElement}catch(_error){}
if(top){poll()}}
doc[add](pre+"DOMContentLoaded",init,!1);doc[add](pre+"readystatechange",init,!1);return win[add](pre+"load",init,!1)}};Tildaupload._autoDiscoverFunction=function(){if(Tildaupload.autoDiscover){return Tildaupload.discover()}};contentLoaded(window,Tildaupload._autoDiscoverFunction)}).call(this);$(document).ready(function(){Tildaupload_URL='https://api.tildacdn.com/api/upload/';$('script[src]').each(function(){var url=$(this).attr('src');if(url.indexOf('tildaupload')!=-1){Tildaupload_URL=url.split('/js/tildaupload');Tildaupload_URL=Tildaupload_URL[0]+'/api/upload/'}});TUWidget={urlUploadAPI:Tildaupload_URL,locale:'EN',dicts:{'EN':{defaultMessage:"Drop files here to upload",fallbackMessage:"Your browser does not support drag'n'drop file uploads.",fallbackText:"Please use the fallback form below to upload your files like in the olden days.",fileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",invalidFileType:"You can't upload files of this type.",responseError:"Server responded with {{statusCode}} code.",cancelUpload:"Cancel upload",cancelUploadConfirmation:"Are you sure you want to cancel this upload?",removeFile:"Remove file",removeFileConfirmation:null,removeAll:"Remove All",browseFiles:"Browse files",fileFromTheWeb:'File from the web',maxFilesExceeded:"You can not upload any more files.",buttonUploadLink:"Upload",buttonUpload:"Upload file",buttonUploads:"Upload files",buttonUploadImage:"Upload image",buttonUploadImages:"Upload images",backToLocalUpload:'Back to local upload',uploadToLink:'Upload to link',uploadToPaste:'Paste',attentionToLink:'Grab any file off the web. Just provide the link.',pasteLink:'Paste your link here',uploading:'Uploading',uploadSelected:'Upload selected',selected:'Youâ€™ve selected {cnt} files'},'RU':{defaultMessage:"Ð‘Ñ€Ð¾ÑÑŒÑ‚Ðµ Ñ„Ð°Ð¹Ð» ÑÑŽÐ´Ð° Ð´Ð»Ñ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸",fallbackMessage:"Ð’Ð°Ñˆ Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€ Ð½Ðµ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð¸Ð²Ð°ÐµÑ‚ Ð´Ñ€Ð°Ð³ Ð°Ð½Ð´ Ð´Ñ€Ð¾Ð¿",fallbackText:"Please use the fallback form below to upload your files like in the olden days.",fileTooBig:"Ð¤Ð°Ð¹Ð» ÑÐ»Ð¸ÑˆÐºÐ¾Ð¼ Ð±Ð¾Ð»ÑŒÑˆÐ¾Ð¹ ({{filesize}}MiB). ÐœÐ°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ€Ð°Ð·Ð¼ÐµÑ€: {{maxFilesize}}MiB.",invalidFileType:"Ð’Ñ‹ Ð½Ðµ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ð·Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ñ„Ð°Ð¹Ð» ÑÑ‚Ð¾Ð³Ð¾ Ñ‚Ð¸Ð¿Ð°",responseError:"Ð¡ÐµÑ€Ð²ÐµÑ€ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ð» Ð¾Ñ‚Ð²ÐµÑ‚ {{statusCode}} ÐºÐ¾Ð´.",cancelUpload:"ÐžÑ‚Ð¼ÐµÐ½Ð° Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸",cancelUploadConfirmation:"Ð’Ñ‹ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ñ…Ð¾Ñ‚Ð¸Ñ‚Ðµ Ð¾Ñ‚Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÑƒ?",removeFile:"Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ñ„Ð°Ð¹Ð»",removeFileConfirmation:null,removeAll:"Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ð²ÑÐµ",browseFiles:"ÐŸÐ¾ÑÐ¼Ð¾Ñ‚Ñ€ÐµÑ‚ÑŒ Ñ„Ð°Ð¹Ð»Ñ‹",maxFilesExceeded:"Ð’Ñ‹ Ð½Ðµ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ð±Ð¾Ð»ÑŒÑˆÐµ Ð·Ð°Ð³Ñ€ÑƒÐ¶Ð°Ñ‚ÑŒ Ñ„Ð°Ð¹Ð»Ñ‹",fileFromTheWeb:'Ð¤Ð°Ð¹Ð» Ð¿Ð¾ ÑÑÑ‹Ð»ÐºÐµ',buttonUploadLink:"Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ",buttonUpload:"Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ñ„Ð°Ð¹Ð»",buttonUploads:"Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ñ„Ð°Ð¹Ð»Ñ‹",buttonUploadImage:"Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ",buttonUploadImages:"Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ",uploadToLink:"Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° Ð¿Ð¾ ÑÑÑ‹Ð»ÐºÐµ",uploadToPaste:"Ð’ÑÑ‚Ð°Ð²Ð¸Ñ‚ÑŒ",backToLocalUpload:'Ð’ÐµÑ€Ð½ÑƒÑ‚ÑŒÑÑ Ðº Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐµ Ñ„Ð°Ð¹Ð»Ð¾Ð² Ñ ÐºÐ¾Ð¼Ð¿ÑŒÑŽÑ‚ÐµÑ€Ð°',attentionToLink:'Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚Ðµ Ð»ÑŽÐ±Ð¾Ð¹ Ñ„Ð°Ð¹Ð» Ð¸Ð· ÑÐµÑ‚Ð¸. ÐŸÑ€Ð¾ÑÑ‚Ð¾ ÑƒÐºÐ°Ð¶Ð¸Ñ‚Ðµ ÑÑÑ‹Ð»ÐºÑƒ.',pasteLink:'Ð’ÑÑ‚Ð°Ð²ÑŒÑ‚Ðµ ÑÑÑ‹Ð»ÐºÑƒ ÑÑŽÐ´Ð°',uploading:'Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ°',uploadSelected:'Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ð¾Ðµ',selected:'Ð’Ñ‹ Ð²Ñ‹Ð±Ñ€Ð°Ð»Ð¸ {cnt}'}}};if($('body').data('lang')=='RU'){TUWidget.locale='RU'}else{TUWidget.locale='EN'}
Tildaupload.autoDiscover=!1;TUWidget.htmlPopup='<div class="tu-popup" id="tu-popup"> <div class="tu-popup-container"> <div class="tu-popup-bg"><input type="text" value="" id="tu-hidden-input-paste" style="position:absolute; opacity:0;width:1px; height:1px;"></div> <div class="tu-popup-close"> <div class="tu-popup-close-line tu-popup-close-line-first"></div> <div class="tu-popup-close-line tu-popup-close-line-second"></div> </div> <div class="tu-popup-wrapper"><div class="tu-popup-closer"></div><div class="tu-popup-content" style="display: block;"> <div class="tu-uploader-steps"> <!-- Muliple screen --> <div class="tu-uploader-multiple"> <div class="tu-uploader-multiple-header"> <div class="tu-uploader-multiple-title"> </div> <div class="tu-uploader-multiple-buttons"> <div class="tu-uploader-multiple-btn tu-uploader-multiple-btn-gray tu-js-removeall">'+TUWidget.dicts[TUWidget.locale].removeAll+'</div> <div class="tu-uploader-multiple-btn tu-uploader-multiple-btn-orange tu-js-selected">'+TUWidget.dicts[TUWidget.locale].uploadSelected+'</div> </div> </div> <div class="tu-uploader-multiple-images"> <div class="tu-uploader-multiple-img-item"> <div class="tu-uploader-multiple-addmore-wrapper"> <div class="tu-uploader-multiple-addmore-separator"></div> <div class="tu-uploader-multiple-addmore-plus"> <div class="tu-uploader-multiple-addmore-plus-line tu-uploader-multiple-addmore-plus-line-first"></div> <div class="tu-uploader-multiple-addmore-plus-line tu-uploader-multiple-addmore-plus-line-second"></div> </div> </div> </div> </div> </div> <!-- uploader main screen --> <div class="tu-uploader-wrapper"> <!--multiple--><div class="tu-uploader-multiple-nav"> <div class="tu-uploader-multiple-nav-title">'+TUWidget.dicts[TUWidget.locale].defaultMessage+'</div> <div class="tu-uploader-multiple-nav-btn">'+TUWidget.dicts[TUWidget.locale].browseFiles+'</div> </div> <!--/end multiple--> <div class="tu-uploader-area"></div> <div class="tu-uploader-title tu-title-lg">'+TUWidget.dicts[TUWidget.locale].defaultMessage+'</div> <div class="tu-uploader-button-wrapper"> <div class="tu-uploader-button tu-clickable">'+TUWidget.dicts[TUWidget.locale].buttonUpload+'</div> </div> <div class="tu-uploader-link-wrapper"> <div class="tu-uploader-link-img tu-uploader-link"> <svg version="1.1" viewBox="0 0 14 14" height="14px" width="14px"> <g fill-rule="evenodd" fill="none" stroke-width="1" stroke="none"> <g fill="#CCCCCC" transform="translate(-311.000000, -503.000000)" sketch:type="MSLayerGroup"> <g transform="translate(311.000000, 503.000000)"> <path id="Shape" d="M9.63740351,6.15189474 C9.46621053,5.76726316 9.22624561,5.40522807 8.91063158,5.08961404 C8.59477193,4.77424561 8.23298246,4.53403509 7.84835088,4.36284211 L7.37185965,4.83933333 L7.04077193,5.17017544 L6.69715789,5.51378947 C6.63329825,5.57740351 6.57901754,5.64666667 6.53161404,5.71912281 C6.9877193,5.74884211 7.41459649,5.93280702 7.74077193,6.25922807 C8.0762807,6.59449123 8.25066667,7.0262807 8.27964912,7.46568421 C8.29610526,7.70982456 8.26589474,7.95445614 8.18754386,8.18901754 C8.10059649,8.44985965 7.96059649,8.6957193 7.75722807,8.90547368 C7.75084211,8.91161404 7.74715789,8.91922807 7.74126316,8.92536842 L7.35098246,9.31515789 L6.80964912,9.85649123 L6.30466667,10.3617193 L4.98842105,11.6779649 C4.6322807,12.0341053 4.15922807,12.2298596 3.65522807,12.2298596 C3.15221053,12.2298596 2.67817544,12.033614 2.32203509,11.6774737 C1.96638596,11.3218246 1.77038596,10.8482807 1.77038596,10.3447719 C1.77038596,9.84126316 1.96614035,9.36747368 2.3222807,9.01157895 L3.64049123,7.69312281 C3.56508772,7.45929825 3.51129825,7.22007018 3.47814035,6.97863158 C3.45357895,6.79859649 3.43687719,6.61757895 3.43614035,6.43607018 C3.43368421,6.10252632 3.47494737,5.76922807 3.55207018,5.44280702 L1.15242105,7.84221053 C-0.229157895,9.2242807 -0.229157895,11.4652632 1.15242105,12.8473333 C1.84357895,13.538 2.74915789,13.8838246 3.65473684,13.8838246 C4.56080702,13.8838246 5.46638596,13.5382456 6.15729825,12.8473333 L8.55326316,10.4513684 L8.91014035,10.0949825 C9.11424561,9.89063158 9.28470175,9.66564912 9.42838596,9.42936842 C9.65459649,9.05849123 9.80835088,8.65666667 9.88522807,8.24207018 C9.92477193,8.02887719 9.94589474,7.81298246 9.94589474,7.59659649 C9.94638596,7.3325614 9.91396491,7.06901754 9.85550877,6.81014035 C9.80540351,6.58540351 9.73270175,6.36508772 9.63740351,6.15189474 L9.63740351,6.15189474 Z"/> <path id="Shape" d="M12.8473333,1.15291228 C12.1561754,0.462 11.2503509,0.116421053 10.3450175,0.116421053 C9.43894737,0.116666667 8.53336842,0.462 7.84245614,1.15315789 L5.44673684,3.54887719 L5.08985965,3.90575439 C4.88550877,4.11010526 4.71529825,4.33508772 4.57136842,4.57112281 C4.34540351,4.942 4.19140351,5.34382456 4.1142807,5.75842105 C4.07473684,5.97161404 4.05361404,6.18775439 4.05361404,6.40389474 C4.05336842,6.66792982 4.08554386,6.93147368 4.144,7.19059649 C4.19484211,7.41508772 4.26754386,7.63540351 4.36284211,7.84884211 C4.53403509,8.23322807 4.77375439,8.59501754 5.08961404,8.91063158 C5.40547368,9.22624561 5.76701754,9.46621053 6.15189474,9.63764912 L6.62814035,9.16140351 L6.95922807,8.8305614 L7.30259649,8.48719298 C7.36645614,8.42333333 7.42098246,8.35407018 7.46838596,8.28136842 C7.01203509,8.25164912 6.58515789,8.06792982 6.25873684,7.74126316 C5.92273684,7.40550877 5.74835088,6.97273684 5.71936842,6.53235088 C5.70364912,6.28894737 5.73435088,6.04554386 5.81221053,5.81147368 C5.89866667,5.55063158 6.03866667,5.30452632 6.24252632,5.09501754 C6.24866667,5.08887719 6.25259649,5.08150877 6.25873684,5.07512281 L6.64877193,4.68508772 L7.19035088,4.14375439 L7.69557895,3.63852632 L9.01157895,2.32277193 C9.3677193,1.96663158 9.84101754,1.77038596 10.3450175,1.77038596 C10.8485263,1.77038596 11.3220702,1.96663158 11.6777193,2.32252632 C12.4130877,3.05764912 12.4130877,4.25378947 11.6782105,4.98866667 L10.3595088,6.30712281 C10.4351579,6.54119298 10.4887018,6.78017544 10.5218596,7.02185965 C10.5466667,7.20189474 10.5631228,7.38291228 10.5638596,7.56417544 C10.5663158,7.89796491 10.5252982,8.23101754 10.4474386,8.5574386 L12.8473333,6.15803509 C14.2289123,4.77596491 14.2289123,2.53498246 12.8473333,1.15291228 L12.8473333,1.15291228 Z"/> </g> </g> </g> </svg> </div> <div class="tu-uploader-link">'+TUWidget.dicts[TUWidget.locale].uploadToLink+'</div><div class="tu-uploader-paste" style="display:none;">'+TUWidget.dicts[TUWidget.locale].uploadToPaste+'</div> </div> </div> <!-- uploader url screen --> <div class="tu-uploaderurl-wrapper"> <div class="tu-uploaderurl-title tu-title-lg">'+TUWidget.dicts[TUWidget.locale].fileFromTheWeb+'</div> <div class="tu-uploadurl-descr tu-descr-sm">'+TUWidget.dicts[TUWidget.locale].attentionToLink+'</div> <div class="tu-uploadurl-form"> <div class="tu-uploadurl-blockinput"> <input placeholder="'+TUWidget.dicts[TUWidget.locale].pasteLink+'" class="tu-uploadurl-input"> </div> <div class="tu-uploadurl-blockbtn"> <button class="tu-uploadurl-btn">'+TUWidget.dicts[TUWidget.locale].buttonUploadLink+'</button> </div> </div> <div class="tu-uploaderurl-link-wrapper"> <div class="tu-uploaderurl-link-img"> <svg viewBox="0 0 4 12" height="12px" width="4px"> <g fill-rule="evenodd" fill="none" stroke-width="1" stroke="none"> <g fill="#FC8665" transform="translate(2.000000, 6.000000) scale(1, -1) translate(-2.000000, -6.000000) "> <path d="M1.8545625,0.1845 L0.09675,3.19035937 C0.0405,3.28879687 0.085359375,3.375 0.197859375,3.375 L1.40639063,3.375 L1.40639063,12 L2.53139063,12 L2.53139063,3.375 L3.71348438,3.375 C3.82598438,3.375 3.88054688,3.28879687 3.81023438,3.19035937 L2.05242188,0.1845 C2.03132813,0.13528125 1.9996875,0.109828125 1.96453125,0.109828125 C1.92923438,0.109828125 1.88971875,0.13528125 1.8545625,0.1845 Z"/> </g> </g> </svg> </div> <div class="tu-uploaderurl-link">'+TUWidget.dicts[TUWidget.locale].backToLocalUpload+'</div> </div> </div> </div> </div></div></div></div>';TUWidget.showUploader=function(){$("#tu-popup").fadeIn(20);$(".tu-popup-content").fadeIn(0,function(){$(this).addClass('tu-popup-content-scale')})}
TUWidget.hideUploader=function(onSelectedFiles){var $popup=$("#tu-popup");if($popup.length==0){return!1}
$popup.fadeOut(40);$("body").removeClass('tu-opened');$popup.find(".tu-popup-content").removeClass('tu-popup-content-scale');window.tu_flag_widget_ui_focus=!1;tu=$popup.data('tildaupload');$elem=$popup.data('tu-original-elem');tu.element=$elem.get(0);if(tu.options.uploadMultiple){var files=tu.getActiveFiles();if(files.length==0&&tu.files.length>0&&onSelectedFiles!=!0){var $prev=$('#'+tu.elementid+'-previews');if($prev.length>0){$prev.removeClass('tu-popup-progressbar-error').removeClass('tu-popup-progressbar-completed').removeClass('tu-popup-progressbar-uploaded').addClass('tu-popup-progressbar-start')}}}
$popup.data('tildaupload','');$popup.remove();$(document).off('paste',TUWidget.popupPasteHandler)};TUWidget.sortFiles=function(){var $popup=$('#tu-popup');if($popup.length>0){var tu=$popup.data('tildaupload');if(tu.files&&tu.files.length>0){var newFiles=[];$popup.find('.tu-js-preview-item').each(function(){var _i=0,file;for(_i=0;_i<tu.files.length;_i++){file=tu.files[_i];if(file&&file.tuInfo&&$(this).data('tu-url')==file.tuInfo.cdnUrl){newFiles.push(file);break}}});if(tu.files.length==newFiles.length){tu.files=newFiles}else{console.log('Error in sort files')}}}}
TUWidget.getPopup=function(){var $popup=$('#tu-popup');if($popup.length==0){$('body').append(TUWidget.htmlPopup);$popup=$('#tu-popup');$popup.find(".tu-uploader-link").click(function(e){$popup.find(".tu-popup-content").addClass('tu-linkupload-screen');return!1});$popup.find(".tu-uploaderurl-link").click(function(e){$popup.find(".tu-popup-content").removeClass('tu-linkupload-screen');return!1});$popup.find(".tu-uploader-multiple-nav-btn").click(function(e){$popup.find(".tu-popup-content").addClass('tu-uploader-multiple-screen')});$popup.find(".tu-uploader-multiple-addmore-wrapper").click(function(e){$popup.find(".tu-popup-content").removeClass('tu-uploader-multiple-screen')});$popup.find(".tu-uploader-paste").click(function(e){var $elem=$popup.data('tu-original-elem');var elemid=$elem.attr('id');var tu=$elem.data('tildaupload');if(!tu){tu=$popup.data('tildaupload')}
tu.paste(e);return!1});$popup.find(".tu-js-selected").click(function(){var _i=0;var $elem=$popup.data('tu-original-elem');var elemid=$elem.attr('id');var tu=$elem.data('tildaupload');if(!tu){tu=$popup.data('tildaupload')}
TUWidget.sortFiles();var files=tu.getActiveFiles();if(files.length>0){TUWidget.hideUploader(!0);return!1}
if(tu.files.length>0){var $previews=$('#'+elemid+'-previews');if($previews.length>0){$previews.removeClass('tu-popup-progressbar-error')}}
$popup.find(".tu-popup-content").removeClass('tu-uploader-multiple-screen');if(tu.onUserDone&&tu.options.uploadMultiple){var fn=tu.onUserDone;fn.call(tu,tu.files);if(files.length==0){tu.removeAllFiles(!0)}}
TUWidget.hideUploader(!0)});$popup.find(".tu-js-removeall").click(function(){var $elem=$popup.data('tu-original-elem');var elemid=$elem.attr('id');var tu=$elem.data('tildaupload');if(!tu){tu=$popup.data('tildaupload')}
tu.removeAllFiles(!0);$popup.find('.tu-uploader-multiple-nav-title').html(TUWidget.dicts[TUWidget.locale].defaultMessage);$popup.find('.tu-uploader-multiple-title').html('');$popup.find(".tu-popup-content").removeClass('tu-uploader-multiple-screen').removeClass('tu-uploader-has-miltiple-img')});$(document).keydown(function(e){if(e.keyCode==27&&$("body").hasClass('tu-opened')){TUWidget.hideUploader()}});$popup.find(".tu-popup-bg, .tu-popup-close, .tu-popup-closer").click(function(e){TUWidget.hideUploader()});$popup.find('.tu-uploadurl-blockbtn').click(function(e){var $elem=$popup.data('tu-original-elem');var elementid=$elem.attr('id');e.preventDefault();var url=$(this).closest('.tu-uploadurl-form').find('.tu-uploadurl-input').val();var tu=$elem.data('tildaupload');if(!tu){tu=$popup.data('tildaupload')}
tu.uploadFileFromURL(url);return!1});$popup.find('.tu-uploader-multiple-images').sortable({helper:'clone',items:"div.tu-js-preview-item",opacity:0.8,placeholder:"tu-uploader-multiple-img-item",revert:!0,scrollSensitivity:10,tolerance:'pointer',});$popup.find('.tu-uploader-multiple-images').disableSelection()}
return $popup}
TUWidget.popupPasteHandler=function(e){$popup=$('#tu-popup');if($popup.find('.tu-linkupload-screen').length==0){var event=e.originalEvent||e;var tu;if(event.clipboardData){console.log('PASTED!='+event+', '+event.clipboardData);if(event.clipboardData.items&&event.clipboardData.items.length>0){tu=$popup.data('tildaupload');tu.paste(event)}else{var tmp=event.clipboardData.getData('text/html');if(tmp&&tmp.toLowerCase().indexOf('<img')>0){tmp=tmp.toLowerCase().split('<img');tmp=tmp[1];tmp=tmp.split('src=');if(tmp[1]){tmp=tmp[1].substring(1);var pos1=tmp.indexOf("'");var pos2=tmp.indexOf('"');if(pos1<pos2&&pos1>0){tmp=tmp.substring(0,pos1)}else{tmp=tmp.substring(0,pos2)}}}
if(tmp==''){tmp=event.clipboardData.getData('text/plain');if(tmp.substring(0,4)!='http'){tmp=''}}
if(tmp>''){$popup.find('.tu-uploader-link').click();$popup.find('.tu-uploadurl-input').val(tmp);$popup.find('.tu-uploadurl-btn').click()}}}else{if(window.clipboardData){if(window.clipboardData.items&&window.clipboardData.items.length>0){tu=$popup.data('tildaupload');tu.paste(window)}else{tmp=window.clipboardData.getData('Html');if(tmp&&tmp.toLowerCase().indexOf('<img')>0){tmp=tmp.toLowerCase().split('<img');tmp=tmp[1];tmp=tmp.split('src=');if(tmp[1]){tmp=tmp[1].substring(1);var pos1=tmp.indexOf("'");var pos2=tmp.indexOf('"');if(pos1<pos2&&pos1>0){tmp=tmp.substring(0,pos1)}else{tmp=tmp.substring(0,pos2)}}
if(tmp==''){tmp=window.clipboardData.getData('Text');if(tmp.substring(0,4)!='http'){tmp=''}}
if(tmp>''){$popup.find('.tu-uploader-link').click();$popup.find('.tu-uploadurl-input').val(tmp);$popup.find('.tu-uploadurl-btn').click()}}}}}
TUWidget.focusHiddenArea();e.preventDefault()}};TUWidget.focusHiddenArea=function(){if($('#tu-popup').find('.tu-linkupload-screen').length==0){var hiddenInput=$('#tu-hidden-input-paste');hiddenInput.val(' ');hiddenInput.focus().select()}};TUWidget.openPopup=function($elem){var $popup=TUWidget.getPopup(),elementid=$elem.attr('id'),tu;tu=$elem.data('tildaupload');tu.element=$popup.find('.tu-uploader-wrapper').get(0);$("body").addClass('tu-opened');window.tu_flag_widget_ui_focus=!0;$popup.data('tu-original-elem',$elem);$popup.data('tildaupload',tu);TUWidget.showUploader();tu.waitCompletedForSuccess=!1;tu.enableAddDropZone();if(tu.files.length>0){tu.removeAllFiles(!0)}
$(document).mouseup(TUWidget.focusHiddenArea);$(document).on('paste',TUWidget.popupPasteHandler);$(document).trigger('mouseup');if(tu.options.uploadMultiple){$popup.find('.tu-uploader-button').html(TUWidget.dicts[TUWidget.locale].buttonUploads)}else{$popup.find('.tu-uploader-button').html(TUWidget.dicts[TUWidget.locale].buttonUpload)}};TUWidget.init=function($elem){if($elem.length==0){var obj={};obj.done=function(){return this};obj.fail=function(){return this};obj.progress=function(){return this};return obj}
var elementid=$elem.attr('id'),myDropzone,idfortildaupload,thumbnailWidth=250,buttonforopendialogid;if(!elementid){elementid='tuwidget'+parseInt(Math.floor(Math.random()*(999999-99999+1))+99999);$elem.attr('id',elementid)}
var multiple=($elem.data('tu-multiple')=='yes'?!0:!1);if($elem.prop('tagName').toUpperCase()=='IMG'){idfortildaupload=elementid;thumbnailWidth=$elem.width();if($elem.data('tu-noclick')=='yes'){buttonforopendialogid=''}else{buttonforopendialogid=elementid}
previewsContainer=idfortildaupload}else{if($elem.prop('tagName').toUpperCase()=='INPUT'){idfortildaupload=elementid+'-previews';idfortildaupload=elementid;previewsContainer=elementid+'-previews';buttonforopendialogid=elementid+'-previews'
if($elem.attr('type')!='hidden'){$elem.hide()}}else{idfortildaupload=elementid;thumbnailWidth=$elem.width();if($elem.data('tu-noclick')!='yes'){buttonforopendialogid=elementid}else{buttonforopendialogid=''}
previewsContainer='';if($elem.attr('data-tu-preview-container')&&$elem.attr('data-tu-preview-container')!='undefined'){previewsContainer=$elem.attr('data-tu-preview-container')}}}
if(!Tildaupload_UPLOADKEY){Tildaupload_UPLOADKEY=''}
myDropzone=new Tildaupload('#'+idfortildaupload,{url:TUWidget.urlUploadAPI+'?publickey='+Tildaupload_PUBLICKEY+'&uploadkey='+Tildaupload_UPLOADKEY,clickable:!1,thumbnailWidth:thumbnailWidth,thumbnailHeight:null,addRemoveLinks:!1,originalelement:$elem.get(0),additionalDropzone:['#tu-popup .tu-uploader-wrapper','#tu-popup  .tu-uploader-multiple-addmore-wrapper'],previewsContainer:previewsContainer?'#'+previewsContainer:null,hiddenInputContainer:$('#'+idfortildaupload).parent().get(0),fileNameSize:22,uploadMultiple:multiple,maxFiles:multiple?50:1,parallelUploads:multiple?3:1,locale:TUWidget.locale,dicts:TUWidget.dicts,acceptedFiles:($elem.data('tu-is-image')=='no'?($elem.data('tu-accepted-files')>''?$elem.data('tu-accepted-files'):!1):'image/*'),});myDropzone.$originalelement=$elem;myDropzone.on('addedfile',function(file){var $elem=this.$originalelement;var elementid=$elem.attr('id');if(this.options.uploadMultiple){}else{if($('#tu-popup').length>0){TUWidget.hideUploader()}
if($elem.prop('tagName')=='IMG'){$elem.css({opacity:0.5});var off=$elem.position();var off2=$elem.offset();if($('#'+elementid+'-progress').length==0){if($elem.hasClass('tn-atom__img')){$elem.after('<div id="'+elementid+'-progress" style="width: '+$elem.width()+'px; height: 3px; box-sizing: border-box; padding: 0; margin:0; position: absolute;background: #222222;"><div style="height: 100%; margin:0; padding:0; background: #FC8665; width: 0%; position: relative;" data-tu-uploadprogress></div></div>')}else{offseth=parseInt(off.top+$elem.height());$elem.after('<div id="'+elementid+'-progress" style="width: '+$elem.width()+'px; height: 3px; box-sizing: border-box; padding: 0; margin:0; position: absolute;background: #222222; top:'+offseth+'px; left: '+off2.left+'px;"><div style="height: 100%; margin:0; padding:0; background: #FC8665; width: 0%; position: relative;" data-tu-uploadprogress></div></div>')}}else{$('#'+elementid+'-progress').show();Tildaupload.setPositionForProgressLine($elem);$('#'+elementid+'-progress').css({background:'#222222'});$('#'+elementid+'-progress > div').css({width:'0px'})}
file.previewElement=null}else{if($elem.prop('tagName')=="INPUT"){}else{if($elem.attr('bgimgfield')>''){if($('#'+elementid+'-progress').length==0){var off=$elem.offset();$elem.prepend('<div id="'+elementid+'-progress" style="width: '+$elem.width()+'px; height: 3px; box-sizing: border-box; padding: 0; margin:0; position: absolute;z-index:100;background: #000000; background: #222222;"><div style="height: 100%; margin:0; padding:0; background: #FC8665; width: 0%; position: relative;" data-tu-uploadprogress></div></div>')}else{console.log('show progress line for bg');$('#'+elementid+'-progress').show();$('#'+elementid+'-progress').css({top:'0',left:'0',background:'#222222'});$('#'+elementid+'-progress > div').css({width:'0px'})}
file.previewElement=null}}}}});myDropzone.on('uploadprogress',function(file,progress,bytesSent){var $elem=this.$originalelement;var elementid=$elem.attr('id');if(this.onUserProgress&&!this.options.uploadMultiple){var fn=this.onUserProgress;fn.call(this,progress,file)}else{if($('#'+elementid+'-progress').length>0){Tildaupload.setPositionForProgressLine($elem);progress=progress*0.8;$('#'+elementid+'-progress').find('div').css({width:progress+'%'});if(progress==80){var opt={width:{start:80,end:95,step:1}};Tildaupload.animate($('#'+elementid+'-progress').find('div').get(0),opt,'slow')}}}});if(multiple){myDropzone.on('addedfiles',function(files){var $elem=this.$originalelement;var elementid=$elem.attr('id');var $previews=$('#'+elementid+'-previews');if($previews.length>0){$previews.find("[data-tu-uploadprogress]").css({width:'0%'});$previews.removeClass('tu-popup-progressbar-start');$previews.removeClass('tu-popup-progressbar-completed');$previews.removeClass('tu-popup-progressbar-uploaded');$previews.find('[data-tu-name]').html('Uploading '+files.length+' files');$('#'+elementid+'-previews').find('[data-tu-size]').html(''+this.sizeUploadedFiles())}else{if($('#'+elementid+'-progress').length>0){Tildaupload.setPositionForProgressLine($elem);$('#'+elementid+'-progress').find('div').css({width:'0%'})}}});myDropzone.on('totaluploadprogress',function(progress,totalBytes,totalBytesSent){var $elem=this.$originalelement;var elementid=$elem.attr('id');if(!this.options.uploadMultiple){return}
if(this.onUserProgress){var fn=this.onUserProgress;fn.call(this,progress)}else{if($('#'+elementid+'-progress').length>0){var off=$elem.position();Tildaupload.setPositionForProgressLine($elem);$('#'+elementid+'-progress').find('div').css({width:progress+'%'})}else{if(this.originalelement&&this.originalelement.nodeName=='INPUT'&&$('#'+elementid+'-previews').length>0){$('#'+elementid+'-previews').find("[data-tu-uploadprogress]").css({width:''+parseInt(progress)+'%'})}}
if(this.options.uploadMultiple&&($popup=$('#tu-popup')).length>0){var cnt=this.files.length;if(cnt==0){$popup.find('.tu-uploader-multiple-nav-title').html('Drop file here');$popup.find('.tu-uploader-multiple-title').html('');$popup.find(".tu-popup-content").removeClass('tu-uploader-multiple-screen').removeClass('tu-uploader-has-miltiple-img');$popup.find('.tu-js-selected').hide();$popup.find('.tu-js-removeall').hide()}else{if(this.options.locale=='RU'){var numText=humanDigits(cnt,['Ñ„Ð°Ð¹Ð»','Ñ„Ð°Ð¹Ð»Ð°','Ñ„Ð°Ð¹Ð»Ð¾Ð²']);$popup.find('.tu-uploader-multiple-title').html('Ð’Ñ‹ Ð²Ñ‹Ð±Ñ€Ð°Ð»Ð¸ '+cnt+' '+numText);$popup.find('.tu-uploader-multiple-nav-title').html('Ð’Ñ‹ Ð²Ñ‹Ð±Ñ€Ð°Ð»Ð¸ '+cnt+' '+numText)}else{if(cnt==1){cnt=cnt+' file'}else{cnt=cnt+' files'}
$popup.find('.tu-uploader-multiple-title').html('Youâ€™ve selected '+cnt);$popup.find('.tu-uploader-multiple-nav-title').html('Youâ€™ve selected '+cnt)}
$popup.find('.tu-js-selected').show();$popup.find('.tu-js-removeall').show();if($('#'+elementid+'-previews').length>0){if(this.options.locale=='RU'){$('#'+elementid+'-previews').find('[data-tu-name]').html('Ð—Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½Ð¾ Ñ„Ð°Ð¹Ð»Ð¾Ð²: '+this.files.length+', ')}else{$('#'+elementid+'-previews').find('[data-tu-name]').html('Uploaded '+this.files.length+' files')}
$('#'+elementid+'-previews').find('[data-tu-size]').html(''+this.sizeUploadedFiles())}}}}});myDropzone.on('successmultiple',function(files,responseText){var $elem=this.$originalelement;var elementid=$elem.attr('id');if(typeof(responseText)=='string'&&responseText.substring(0,1)=='{'){responseText=$.parseJSON(responseText)}
if(responseText.result&&responseText.result.length>0){for(var i=0;i<responseText.result.length;i++){for(var j=0;j<this.files.length;j++){if((this.files[j].name==responseText.result[i].originalUrl)||(this.files[j].name==undefined&&responseText.result[i].originalUrl=='blob')){this.files[j].tuInfo=responseText.result[i];break}}}}
if(this.originalelement&&this.originalelement.nodeName=='IMG'){$elem.css({opacity:1});if($('#'+elementid+'-progress').length>0){setTimeout(function(){$('#'+elementid+'-progress').fadeOut(20)},500)}}else{if(this.originalelement&&this.originalelement.nodeName=='INPUT'&&$('#'+elementid+'-previews').length>0){var $previews=$('#'+elementid+'-previews');$previews.addClass('tu-popup-progressbar-uploaded');var iCountUploading=this.getActiveFiles().length;var iCountUploaded=this.files.length-iCountUploading;if(this.options.locale=='RU'){if(iCountUploading>0){$previews.find('[data-tu-name]').html('Ð—Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½Ð¾ Ñ„Ð°Ð¹Ð»Ð¾Ð²: '+iCountUploaded+' Ð¸Ð· '+this.files.length+', ')}else{$previews.find('[data-tu-name]').html('Ð—Ð°Ð³Ñ€ÑƒÐ¶ÐµÐ½Ð¾ Ñ„Ð°Ð¹Ð»Ð¾Ð²: '+iCountUploaded+', ')}}else{if(iCountUploading>0){$previews.find('[data-tu-name]').html('Uploaded '+iCountUploaded+' from '+this.files.length+' files')}else{$previews.find('[data-tu-name]').html('Uploaded '+iCountUploaded+' files')}}
$previews.find('[data-tu-size]').html(''+this.sizeUploadedFiles());var _this=this;window.setTimeout(function(){$previews.removeClass('tu-popup-progressbar-uploaded');$previews.addClass('tu-popup-progressbar-completed');$previews.find("[data-tu-uploadprogress]").css({width:'0%'})},500)}}
if($('#tu-popup').length==0&&this.getActiveFiles().length==0){if(this.onUserDone&&this.options.uploadMultiple){var fn=this.onUserDone;fn.call(this,this.files)}}});myDropzone.on('errormultiple',function(files){var $elem=this.$originalelement;var elementid=$elem.attr('id');if(this.originalelement&&this.originalelement.nodeName=='IMG'){if($('#'+elementid+'-progress').length>0){$('#'+elementid+'-progress').css({background:'#FF2222'})}}else{if(this.originalelement&&this.originalelement.nodeName=='INPUT'&&$('#'+elementid+'-previews').length>0){var $previews=$('#'+elementid+'-previews');$previews.addClass('tu-popup-progressbar-error');$previews.find('[data-tu-errormessage]').html('Error !')}}
console.log('_['+elementid+'] error multiple: '+files.length)});myDropzone.on('completemultiple',function(files){var $elem=this.$originalelement;var elementid=$elem.attr('id');if(this.options.uploadMultiple&&files){for(var i=0;i<files.length;i++){file=files[i]}}
if($('#tu-popup').length==0&&this.getActiveFiles().length==0){this.removeAllFiles(!0)}})}
myDropzone.on('thumbnail',function(file,dataUrl){var $elem=this.$originalelement;var elementid=$elem.attr('id');if(this.options.uploadMultiple){}else{if($elem.prop('tagName')=='IMG'){$elem.attr('src',dataUrl)}else{if($elem.attr('bgimgfield')){if($elem.find('.t-cover__carrier').length>0){$elem.find('.t-cover__carrier').css({'background-image':'url('+dataUrl+')'})}else{$elem.css({'background-image':'url('+dataUrl+')'})}}else{if($('#'+elementid+'-thumb').length==0){if($('#'+elementid+'-previews').length>0){}}else{if(file.type.substring(0,6)=='image/'){$('#'+elementid+'-thumb').html('<img src="'+dataUrl+'" width="250">')}}}}}});myDropzone.on('success',function(file,response){var $elem=this.$originalelement;var elementid=$elem.attr('id');var erroruploadtxt='',errorTitle='Upload error >';var off;if(!file.tuInfo){file.tuInfo={}}
serverText=response;if(typeof response=='string'){console.log('_[#'+elementid+'] success event error: '+response)}
if(response&&typeof response=='string'&&response.substring(0,1)=='{'){response=$.parseJSON(response)}
if(response&&response.result&&response.result.length>0){if(this.options.uploadMultiple){}else{file.tuInfo=response.result[0];if($elem.prop('tagName')=='IMG'){$elem.attr('src',response.result[0].cdnUrl).css({opacity:1});$elem.data('tu-value',response.result[0].cdnUrl)}else{if($elem.attr('bgimgfield')){if($elem.find('.t-cover__carrier').length>0){$elem.find('.t-cover__carrier').css({'background-image':'url('+response.result[0].cdnUrl+')'})}else{$elem.css({'background-image':'url('+response.result[0].cdnUrl+')'})}
$elem.data('tu-value',response.result[0].cdnUrl)}else{erroruploadtxt='';$elem.val(response.result[0].cdnUrl);if(response.result[0].cdnUrl>''){if($('#'+elementid+'-thumb').length==0){}else{if(file.type.substring(0,6)=='image/'){$('#'+elementid+'-thumb').html('<img src="'+response.result[0].cdnUrl+'" width="250">')}else{$('#'+elementid+'-thumb').html(response.result[0].cdnUrl)}}}else{if(response.result[0].error&&response.result[0].error>''){erroruploadtxt=response.result[0].error+'<br>'}else{erroruploadtxt='Upload error. Reload page and try again.'}}
var $previews=$('#'+elementid+'-previews');if(erroruploadtxt>''){if($previews.length>0){if(erroruploadtxt.length>25){errorTitle=erroruploadtxt.substring(0,23)+'...'}else{errorTitle=erroruploadtxt}
$previews.find('.tu-popup-progressbar-error-title').html(errorTitle)
$previews.removeClass('tu-popup-progressbar-completed');$previews.removeClass('tu-popup-progressbar-success');$previews.removeClass('tu-popup-progressbar-start');$previews.addClass('tu-popup-progressbar-error');$previews.find('.tu-popup-progressbar-error-text').html(erroruploadtxt);window.setTimeout(function(){$previews.removeClass('tu-popup-progressbar-error');$previews.addClass('tu-popup-progressbar-start')},5000)}else{if($('#'+elementid+'-progress').length>0){Tildaupload.setPositionForProgressLine($elem);$('#'+elementid+'-progress').css({background:'#FF2222'})}}
if(tu.onUserFail&&!tu.options.uploadMultiple){var fn=tu.onUserFail;fn.call(tu,file,response)}}else{$previews.addClass('tu-popup-progressbar-uploaded');window.setTimeout(function(){$previews.removeClass('tu-popup-progressbar-uploaded');$previews.addClass('tu-popup-progressbar-completed');$previews.find('[data-tu-uploadprogress]').css({'width':'0%'})},500)}}}}}else{console.log('event success ['+elementid+']: error: '+serverText);var tu=$elem.data('tildaupload');var $previews=$('#'+elementid+'-previews');if($previews.length>0){$previews.removeClass('tu-popup-progressbar-completed');$previews.removeClass('tu-popup-progressbar-success');$previews.removeClass('tu-popup-progressbar-start');$previews.addClass('tu-popup-progressbar-error');var errorText='',errorTitle='Upload error >',ee;if(response&&response.result&&response.result[0]){for(ee in response.result){if(response.result[ee].error&&response.result[ee].error>''){errorText+=response.result[ee].error+'<br>'}}}else{if(response&&response.error>''){errorText=response.error+'<br>'}}
if(errorText==''){errorText='Upload only image files'}
if(errorText.length>25){errorTitle=errorText.substring(0,23)+'...'}else{errorTitle=errorText}
$previews.find('.tu-popup-progressbar-error-title').html(errorTitle)
$previews.find('.tu-popup-progressbar-error-text').html(errorText);window.setTimeout(function(){$previews.removeClass('tu-popup-progressbar-error');$previews.addClass('tu-popup-progressbar-start')},5000)}else{if($('#'+elementid+'-progress').length>0){Tildaupload.setPositionForProgressLine($elem);$('#'+elementid+'-progress').css({background:'#FF2222'})}}
if(tu.onUserFail&&!tu.options.uploadMultiple){var fn=tu.onUserFail;fn.call(tu,file,response)}}
if(this.onUserDone&&!this.options.uploadMultiple){var fn=this.onUserDone;fn.call(this,file)}});myDropzone.on('complete',function(file){var $elem=this.$originalelement;var elementid=$elem.attr('id');$('[data-tu-ondrag-hide=yes]').each(function(){if($(this).css('display')=='none'&&$(this).data('tu-old-display')){$(this).css({display:$(this).data('tu-old-display')})}});if(this.options.uploadMultiple){}else{file.previewElement=Tildaupload.createElement('<div></div>');if($elem.prop('tagName')=='IMG'){$elem.css({opacity:1});if($('#'+elementid+'-progress').length>0){setTimeout(function(){$('#'+elementid+'-progress').fadeOut(20).remove()},500)}}else{if($('#'+elementid+'-progress').length>0){setTimeout(function(){$('#'+elementid+'-progress').fadeOut(20).remove()},500)}else{if($('#'+elementid+'-previews').length>0&&$('#'+elementid+'-previews').find('[data-tu-size]').length>0){$('#'+elementid+'-previews').find('[data-tu-size]').html(this.filesize(file.size))}}}}});myDropzone.on('queuecomplete',function(){var $elem=this.$originalelement;var elementid=$elem.attr('id');if(!this.options.uploadMultiple){this.removeAllFiles()}});$elem.data('tildaupload',myDropzone);if(buttonforopendialogid){$('#'+buttonforopendialogid).click(function(e){e.preventDefault();TUWidget.openPopup($elem);return!1})}
return myDropzone};$('[data-tu-ondrag-hide=yes]').on('dragstart dragenter dragover',function(){if($(this).css('display')!='none'){$(this).data('tu-old-display',$(this).css('display'));$(this).css({display:'none'})}})})